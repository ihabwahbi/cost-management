(()=>{var e={};e.id=895,e.ids=[895],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},68621:e=>{"use strict";e.exports=require("punycode")},76162:e=>{"use strict";e.exports=require("stream")},17360:e=>{"use strict";e.exports=require("url")},71568:e=>{"use strict";e.exports=require("zlib")},22186:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>h,tree:()=>d}),s(58643),s(94489),s(12696);var r=s(19737),a=s(29722),n=s(77935),i=s.n(n),l=s(2385),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let d=["",{children:["projects",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,58643)),"/home/iwahbi/dev/cost-management-v0/apps/web/app/projects/page.tsx"]}]},{loading:[()=>Promise.resolve().then(s.bind(s,25616)),"/home/iwahbi/dev/cost-management-v0/apps/web/app/projects/loading.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,94489)),"/home/iwahbi/dev/cost-management-v0/apps/web/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,12696,23)),"next/dist/client/components/not-found-error"]}],c=["/home/iwahbi/dev/cost-management-v0/apps/web/app/projects/page.tsx"],u="/projects/page",m={require:s,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/projects/page",pathname:"/projects",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},39099:(e,t,s)=>{Promise.resolve().then(s.bind(s,25759))},20004:()=>{},25759:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>rF});var r=s(30817),a=s(19196),n=s(18369),i=s(67671),l=s(50367);let o=(0,l.Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);var d=s(42070);let c=(0,l.Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var u=s(18119),m=s(49755),h=s(61601);let x={pending:{color:"bg-yellow-100 text-yellow-800 border-yellow-300",icon:o,label:"Pending"},saved:{color:"bg-green-100 text-green-800 border-green-300",icon:d.Z,label:"Saved"},error:{color:"bg-red-100 text-red-800 border-red-300",icon:c,label:"Error"},syncing:{color:"bg-blue-100 text-blue-800 border-blue-300",icon:u.Z,label:"Syncing"},staged:{color:"bg-amber-100 text-amber-800 border-amber-300",icon:m.Z,label:"Staged"},modified:{color:"bg-indigo-100 text-indigo-800 border-indigo-300",icon:m.Z,label:"Modified"}};function p({id:e,modified:t=!1,saving:s=!1,error:a=!1}){let n=e?.startsWith("temp_"),l="saved";a?l="error":s?l="syncing":n?l="staged":t&&(l="modified");let o=x[l],d=o.icon;return"string"==typeof a||o.label,(0,r.jsxs)(i.C,{variant:"outline",className:(0,h.cn)(o.color,s&&"animate-pulse","transition-all duration-200"),title:"error"===l&&"string"==typeof a?a:void 0,children:[r.jsx(d,{className:(0,h.cn)("w-3 h-3 mr-1","syncing"===l&&"animate-spin")}),"error"===l&&"string"==typeof a?"Error":o.label]})}let g=(0,l.Z)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var f=s(49281),b=s(207);function v({count:e,onSave:t,onDiscard:s}){return 0===e?null:(0,r.jsxs)("div",{className:"fixed bottom-4 right-4 z-50 bg-amber-100 border-2 border-amber-300 rounded-lg shadow-lg p-4 max-w-sm",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx(m.Z,{className:"w-5 h-5 text-amber-600 flex-shrink-0"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("p",{className:"text-sm font-medium text-amber-900",children:[e," unsaved ",1===e?"change":"changes"]}),r.jsx("p",{className:"text-xs text-amber-700 mt-1",children:"Your changes will be lost if you leave"})]})]}),(0,r.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,r.jsxs)(b.z,{size:"sm",onClick:t,className:"flex-1 bg-amber-600 hover:bg-amber-700",children:[r.jsx(g,{className:"w-3 h-3 mr-1"}),"Save All"]}),(0,r.jsxs)(b.z,{size:"sm",variant:"outline",onClick:s,className:"flex-1",children:[r.jsx(f.Z,{className:"w-3 h-3 mr-1"}),"Discard"]})]})]})}var j=s(42223),y=s(33312),w=s(40060),N=s(43737),_=s(41116),C=s(77901),k=s(66466),S=s(2358),E=s(50220),P=s(46655),D=s(49191),T=s(7470),M=s(28881),z=s(94291),R="Dialog",[F,I]=(0,w.b)(R),[L,$]=F(R),A=e=>{let{__scopeDialog:t,children:s,open:n,defaultOpen:i,onOpenChange:l,modal:o=!0}=e,d=a.useRef(null),c=a.useRef(null),[u=!1,m]=(0,_.T)({prop:n,defaultProp:i,onChange:l});return(0,r.jsx)(L,{scope:t,triggerRef:d,contentRef:c,contentId:(0,N.M)(),titleId:(0,N.M)(),descriptionId:(0,N.M)(),open:u,onOpenChange:m,onOpenToggle:a.useCallback(()=>m(e=>!e),[m]),modal:o,children:s})};A.displayName=R;var V="DialogTrigger",O=a.forwardRef((e,t)=>{let{__scopeDialog:s,...a}=e,n=$(V,s),i=(0,y.e)(t,n.triggerRef);return(0,r.jsx)(P.WV.button,{type:"button","aria-haspopup":"dialog","aria-expanded":n.open,"aria-controls":n.contentId,"data-state":ei(n.open),...a,ref:i,onClick:(0,j.M)(e.onClick,n.onOpenToggle)})});O.displayName=V;var Z="DialogPortal",[B,W]=F(Z,{forceMount:void 0}),U=e=>{let{__scopeDialog:t,forceMount:s,children:n,container:i}=e,l=$(Z,t);return(0,r.jsx)(B,{scope:t,forceMount:s,children:a.Children.map(n,e=>(0,r.jsx)(E.z,{present:s||l.open,children:(0,r.jsx)(S.h,{asChild:!0,container:i,children:e})}))})};U.displayName=Z;var q="DialogOverlay",Y=a.forwardRef((e,t)=>{let s=W(q,e.__scopeDialog),{forceMount:a=s.forceMount,...n}=e,i=$(q,e.__scopeDialog);return i.modal?(0,r.jsx)(E.z,{present:a||i.open,children:(0,r.jsx)(H,{...n,ref:t})}):null});Y.displayName=q;var H=a.forwardRef((e,t)=>{let{__scopeDialog:s,...a}=e,n=$(q,s);return(0,r.jsx)(T.Z,{as:z.g7,allowPinchZoom:!0,shards:[n.contentRef],children:(0,r.jsx)(P.WV.div,{"data-state":ei(n.open),...a,ref:t,style:{pointerEvents:"auto",...a.style}})})}),K="DialogContent",G=a.forwardRef((e,t)=>{let s=W(K,e.__scopeDialog),{forceMount:a=s.forceMount,...n}=e,i=$(K,e.__scopeDialog);return(0,r.jsx)(E.z,{present:a||i.open,children:i.modal?(0,r.jsx)(X,{...n,ref:t}):(0,r.jsx)(Q,{...n,ref:t})})});G.displayName=K;var X=a.forwardRef((e,t)=>{let s=$(K,e.__scopeDialog),n=a.useRef(null),i=(0,y.e)(t,s.contentRef,n);return a.useEffect(()=>{let e=n.current;if(e)return(0,M.Ry)(e)},[]),(0,r.jsx)(J,{...e,ref:i,trapFocus:s.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:(0,j.M)(e.onCloseAutoFocus,e=>{e.preventDefault(),s.triggerRef.current?.focus()}),onPointerDownOutside:(0,j.M)(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,s=0===t.button&&!0===t.ctrlKey;(2===t.button||s)&&e.preventDefault()}),onFocusOutside:(0,j.M)(e.onFocusOutside,e=>e.preventDefault())})}),Q=a.forwardRef((e,t)=>{let s=$(K,e.__scopeDialog),n=a.useRef(!1),i=a.useRef(!1);return(0,r.jsx)(J,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{e.onCloseAutoFocus?.(t),t.defaultPrevented||(n.current||s.triggerRef.current?.focus(),t.preventDefault()),n.current=!1,i.current=!1},onInteractOutside:t=>{e.onInteractOutside?.(t),t.defaultPrevented||(n.current=!0,"pointerdown"!==t.detail.originalEvent.type||(i.current=!0));let r=t.target;s.triggerRef.current?.contains(r)&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&i.current&&t.preventDefault()}})}),J=a.forwardRef((e,t)=>{let{__scopeDialog:s,trapFocus:n,onOpenAutoFocus:i,onCloseAutoFocus:l,...o}=e,d=$(K,s),c=a.useRef(null),u=(0,y.e)(t,c);return(0,D.EW)(),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(k.M,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:i,onUnmountAutoFocus:l,children:(0,r.jsx)(C.XB,{role:"dialog",id:d.contentId,"aria-describedby":d.descriptionId,"aria-labelledby":d.titleId,"data-state":ei(d.open),...o,ref:u,onDismiss:()=>d.onOpenChange(!1)})}),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ec,{titleId:d.titleId}),(0,r.jsx)(eu,{contentRef:c,descriptionId:d.descriptionId})]})]})}),ee="DialogTitle",et=a.forwardRef((e,t)=>{let{__scopeDialog:s,...a}=e,n=$(ee,s);return(0,r.jsx)(P.WV.h2,{id:n.titleId,...a,ref:t})});et.displayName=ee;var es="DialogDescription",er=a.forwardRef((e,t)=>{let{__scopeDialog:s,...a}=e,n=$(es,s);return(0,r.jsx)(P.WV.p,{id:n.descriptionId,...a,ref:t})});er.displayName=es;var ea="DialogClose",en=a.forwardRef((e,t)=>{let{__scopeDialog:s,...a}=e,n=$(ea,s);return(0,r.jsx)(P.WV.button,{type:"button",...a,ref:t,onClick:(0,j.M)(e.onClick,()=>n.onOpenChange(!1))})});function ei(e){return e?"open":"closed"}en.displayName=ea;var el="DialogTitleWarning",[eo,ed]=(0,w.k)(el,{contentName:K,titleName:ee,docsSlug:"dialog"}),ec=({titleId:e})=>{let t=ed(el),s=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return a.useEffect(()=>{e&&!document.getElementById(e)&&console.error(s)},[s,e]),null},eu=({contentRef:e,descriptionId:t})=>{let s=ed("DialogDescriptionWarning"),r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${s.contentName}}.`;return a.useEffect(()=>{let s=e.current?.getAttribute("aria-describedby");t&&s&&!document.getElementById(t)&&console.warn(r)},[r,e,t]),null};function em({...e}){return r.jsx(A,{"data-slot":"dialog",...e})}function eh({...e}){return r.jsx(O,{"data-slot":"dialog-trigger",...e})}function ex({...e}){return r.jsx(U,{"data-slot":"dialog-portal",...e})}let ep=a.forwardRef(({className:e,...t},s)=>r.jsx(Y,{ref:s,"data-slot":"dialog-overlay",className:(0,h.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t}));function eg({className:e,children:t,showCloseButton:s=!0,...a}){return(0,r.jsxs)(ex,{"data-slot":"dialog-portal",children:[r.jsx(ep,{}),(0,r.jsxs)(G,{"data-slot":"dialog-content",className:(0,h.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...a,children:[t,s&&(0,r.jsxs)(en,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[r.jsx(f.Z,{}),r.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function ef({className:e,...t}){return r.jsx("div",{"data-slot":"dialog-header",className:(0,h.cn)("flex flex-col gap-2 text-center sm:text-left",e),...t})}function eb({className:e,...t}){return r.jsx("div",{"data-slot":"dialog-footer",className:(0,h.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...t})}function ev({className:e,...t}){return r.jsx(et,{"data-slot":"dialog-title",className:(0,h.cn)("text-lg leading-none font-semibold",e),...t})}function ej({className:e,...t}){return r.jsx(er,{"data-slot":"dialog-description",className:(0,h.cn)("text-muted-foreground text-sm",e),...t})}ep.displayName=Y.displayName;var ey=s(54634),ew=s(64221),eN=s(25478),e_=s(76240),eC=s(33865),ek=s(15318),eS=s(59093),eE=s(28802),eP="ScrollArea",[eD,eT]=(0,w.b)(eP),[eM,ez]=eD(eP),eR=a.forwardRef((e,t)=>{let{__scopeScrollArea:s,type:n="hover",dir:i,scrollHideDelay:l=600,...o}=e,[d,c]=a.useState(null),[u,m]=a.useState(null),[h,x]=a.useState(null),[p,g]=a.useState(null),[f,b]=a.useState(null),[v,j]=a.useState(0),[w,N]=a.useState(0),[_,C]=a.useState(!1),[k,S]=a.useState(!1),E=(0,y.e)(t,e=>c(e)),D=(0,ek.gm)(i);return(0,r.jsx)(eM,{scope:s,type:n,dir:D,scrollHideDelay:l,scrollArea:d,viewport:u,onViewportChange:m,content:h,onContentChange:x,scrollbarX:p,onScrollbarXChange:g,scrollbarXEnabled:_,onScrollbarXEnabledChange:C,scrollbarY:f,onScrollbarYChange:b,scrollbarYEnabled:k,onScrollbarYEnabledChange:S,onCornerWidthChange:j,onCornerHeightChange:N,children:(0,r.jsx)(P.WV.div,{dir:D,...o,ref:E,style:{position:"relative","--radix-scroll-area-corner-width":v+"px","--radix-scroll-area-corner-height":w+"px",...e.style}})})});eR.displayName=eP;var eF="ScrollAreaViewport",eI=a.forwardRef((e,t)=>{let{__scopeScrollArea:s,children:n,nonce:i,...l}=e,o=ez(eF,s),d=a.useRef(null),c=(0,y.e)(t,d,o.onViewportChange);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),(0,r.jsx)(P.WV.div,{"data-radix-scroll-area-viewport":"",...l,ref:c,style:{overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden",...e.style},children:(0,r.jsx)("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:n})})]})});eI.displayName=eF;var eL="ScrollAreaScrollbar",e$=a.forwardRef((e,t)=>{let{forceMount:s,...n}=e,i=ez(eL,e.__scopeScrollArea),{onScrollbarXEnabledChange:l,onScrollbarYEnabledChange:o}=i,d="horizontal"===e.orientation;return a.useEffect(()=>(d?l(!0):o(!0),()=>{d?l(!1):o(!1)}),[d,l,o]),"hover"===i.type?(0,r.jsx)(eA,{...n,ref:t,forceMount:s}):"scroll"===i.type?(0,r.jsx)(eV,{...n,ref:t,forceMount:s}):"auto"===i.type?(0,r.jsx)(eO,{...n,ref:t,forceMount:s}):"always"===i.type?(0,r.jsx)(eZ,{...n,ref:t}):null});e$.displayName=eL;var eA=a.forwardRef((e,t)=>{let{forceMount:s,...n}=e,i=ez(eL,e.__scopeScrollArea),[l,o]=a.useState(!1);return a.useEffect(()=>{let e=i.scrollArea,t=0;if(e){let s=()=>{window.clearTimeout(t),o(!0)},r=()=>{t=window.setTimeout(()=>o(!1),i.scrollHideDelay)};return e.addEventListener("pointerenter",s),e.addEventListener("pointerleave",r),()=>{window.clearTimeout(t),e.removeEventListener("pointerenter",s),e.removeEventListener("pointerleave",r)}}},[i.scrollArea,i.scrollHideDelay]),(0,r.jsx)(E.z,{present:s||l,children:(0,r.jsx)(eO,{"data-state":l?"visible":"hidden",...n,ref:t})})}),eV=a.forwardRef((e,t)=>{var s,n;let{forceMount:i,...l}=e,o=ez(eL,e.__scopeScrollArea),d="horizontal"===e.orientation,c=e5(()=>m("SCROLL_END"),100),[u,m]=(s="hidden",n={hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}},a.useReducer((e,t)=>n[e][t]??e,s));return a.useEffect(()=>{if("idle"===u){let e=window.setTimeout(()=>m("HIDE"),o.scrollHideDelay);return()=>window.clearTimeout(e)}},[u,o.scrollHideDelay,m]),a.useEffect(()=>{let e=o.viewport,t=d?"scrollLeft":"scrollTop";if(e){let s=e[t],r=()=>{let r=e[t];s!==r&&(m("SCROLL"),c()),s=r};return e.addEventListener("scroll",r),()=>e.removeEventListener("scroll",r)}},[o.viewport,d,m,c]),(0,r.jsx)(E.z,{present:i||"hidden"!==u,children:(0,r.jsx)(eZ,{"data-state":"hidden"===u?"hidden":"visible",...l,ref:t,onPointerEnter:(0,j.M)(e.onPointerEnter,()=>m("POINTER_ENTER")),onPointerLeave:(0,j.M)(e.onPointerLeave,()=>m("POINTER_LEAVE"))})})}),eO=a.forwardRef((e,t)=>{let s=ez(eL,e.__scopeScrollArea),{forceMount:n,...i}=e,[l,o]=a.useState(!1),d="horizontal"===e.orientation,c=e5(()=>{if(s.viewport){let e=s.viewport.offsetWidth<s.viewport.scrollWidth,t=s.viewport.offsetHeight<s.viewport.scrollHeight;o(d?e:t)}},10);return e7(s.viewport,c),e7(s.content,c),(0,r.jsx)(E.z,{present:n||l,children:(0,r.jsx)(eZ,{"data-state":l?"visible":"hidden",...i,ref:t})})}),eZ=a.forwardRef((e,t)=>{let{orientation:s="vertical",...n}=e,i=ez(eL,e.__scopeScrollArea),l=a.useRef(null),o=a.useRef(0),[d,c]=a.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=e1(d.viewport,d.content),m={...n,sizes:d,onSizesChange:c,hasThumb:!!(u>0&&u<1),onThumbChange:e=>l.current=e,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:e=>o.current=e};function h(e,t){return function(e,t,s,r="ltr"){let a=e2(s),n=t||a/2,i=s.scrollbar.paddingStart+n,l=s.scrollbar.size-s.scrollbar.paddingEnd-(a-n),o=s.content-s.viewport;return e6([i,l],"ltr"===r?[0,o]:[-1*o,0])(e)}(e,o.current,d,t)}return"horizontal"===s?(0,r.jsx)(eB,{...m,ref:t,onThumbPositionChange:()=>{if(i.viewport&&l.current){let e=e4(i.viewport.scrollLeft,d,i.dir);l.current.style.transform=`translate3d(${e}px, 0, 0)`}},onWheelScroll:e=>{i.viewport&&(i.viewport.scrollLeft=e)},onDragScroll:e=>{i.viewport&&(i.viewport.scrollLeft=h(e,i.dir))}}):"vertical"===s?(0,r.jsx)(eW,{...m,ref:t,onThumbPositionChange:()=>{if(i.viewport&&l.current){let e=e4(i.viewport.scrollTop,d);l.current.style.transform=`translate3d(0, ${e}px, 0)`}},onWheelScroll:e=>{i.viewport&&(i.viewport.scrollTop=e)},onDragScroll:e=>{i.viewport&&(i.viewport.scrollTop=h(e))}}):null}),eB=a.forwardRef((e,t)=>{let{sizes:s,onSizesChange:n,...i}=e,l=ez(eL,e.__scopeScrollArea),[o,d]=a.useState(),c=a.useRef(null),u=(0,y.e)(t,c,l.onScrollbarXChange);return a.useEffect(()=>{c.current&&d(getComputedStyle(c.current))},[c]),(0,r.jsx)(eY,{"data-orientation":"horizontal",...i,ref:u,sizes:s,style:{bottom:0,left:"rtl"===l.dir?"var(--radix-scroll-area-corner-width)":0,right:"ltr"===l.dir?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":e2(s)+"px",...e.style},onThumbPointerDown:t=>e.onThumbPointerDown(t.x),onDragScroll:t=>e.onDragScroll(t.x),onWheelScroll:(t,s)=>{if(l.viewport){let r=l.viewport.scrollLeft+t.deltaX;e.onWheelScroll(r),function(e,t){return e>0&&e<t}(r,s)&&t.preventDefault()}},onResize:()=>{c.current&&l.viewport&&o&&n({content:l.viewport.scrollWidth,viewport:l.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:e0(o.paddingLeft),paddingEnd:e0(o.paddingRight)}})}})}),eW=a.forwardRef((e,t)=>{let{sizes:s,onSizesChange:n,...i}=e,l=ez(eL,e.__scopeScrollArea),[o,d]=a.useState(),c=a.useRef(null),u=(0,y.e)(t,c,l.onScrollbarYChange);return a.useEffect(()=>{c.current&&d(getComputedStyle(c.current))},[c]),(0,r.jsx)(eY,{"data-orientation":"vertical",...i,ref:u,sizes:s,style:{top:0,right:"ltr"===l.dir?0:void 0,left:"rtl"===l.dir?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":e2(s)+"px",...e.style},onThumbPointerDown:t=>e.onThumbPointerDown(t.y),onDragScroll:t=>e.onDragScroll(t.y),onWheelScroll:(t,s)=>{if(l.viewport){let r=l.viewport.scrollTop+t.deltaY;e.onWheelScroll(r),function(e,t){return e>0&&e<t}(r,s)&&t.preventDefault()}},onResize:()=>{c.current&&l.viewport&&o&&n({content:l.viewport.scrollHeight,viewport:l.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:e0(o.paddingTop),paddingEnd:e0(o.paddingBottom)}})}})}),[eU,eq]=eD(eL),eY=a.forwardRef((e,t)=>{let{__scopeScrollArea:s,sizes:n,hasThumb:i,onThumbChange:l,onThumbPointerUp:o,onThumbPointerDown:d,onThumbPositionChange:c,onDragScroll:u,onWheelScroll:m,onResize:h,...x}=e,p=ez(eL,s),[g,f]=a.useState(null),b=(0,y.e)(t,e=>f(e)),v=a.useRef(null),w=a.useRef(""),N=p.viewport,_=n.content-n.viewport,C=(0,eC.W)(m),k=(0,eC.W)(c),S=e5(h,10);function E(e){v.current&&u({x:e.clientX-v.current.left,y:e.clientY-v.current.top})}return a.useEffect(()=>{let e=e=>{let t=e.target;g?.contains(t)&&C(e,_)};return document.addEventListener("wheel",e,{passive:!1}),()=>document.removeEventListener("wheel",e,{passive:!1})},[N,g,_,C]),a.useEffect(k,[n,k]),e7(g,S),e7(p.content,S),(0,r.jsx)(eU,{scope:s,scrollbar:g,hasThumb:i,onThumbChange:(0,eC.W)(l),onThumbPointerUp:(0,eC.W)(o),onThumbPositionChange:k,onThumbPointerDown:(0,eC.W)(d),children:(0,r.jsx)(P.WV.div,{...x,ref:b,style:{position:"absolute",...x.style},onPointerDown:(0,j.M)(e.onPointerDown,e=>{0===e.button&&(e.target.setPointerCapture(e.pointerId),v.current=g.getBoundingClientRect(),w.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",p.viewport&&(p.viewport.style.scrollBehavior="auto"),E(e))}),onPointerMove:(0,j.M)(e.onPointerMove,E),onPointerUp:(0,j.M)(e.onPointerUp,e=>{let t=e.target;t.hasPointerCapture(e.pointerId)&&t.releasePointerCapture(e.pointerId),document.body.style.webkitUserSelect=w.current,p.viewport&&(p.viewport.style.scrollBehavior=""),v.current=null})})})}),eH="ScrollAreaThumb",eK=a.forwardRef((e,t)=>{let{forceMount:s,...a}=e,n=eq(eH,e.__scopeScrollArea);return(0,r.jsx)(E.z,{present:s||n.hasThumb,children:(0,r.jsx)(eG,{ref:t,...a})})}),eG=a.forwardRef((e,t)=>{let{__scopeScrollArea:s,style:n,...i}=e,l=ez(eH,s),o=eq(eH,s),{onThumbPositionChange:d}=o,c=(0,y.e)(t,e=>o.onThumbChange(e)),u=a.useRef(void 0),m=e5(()=>{u.current&&(u.current(),u.current=void 0)},100);return a.useEffect(()=>{let e=l.viewport;if(e){let t=()=>{if(m(),!u.current){let t=e3(e,d);u.current=t,d()}};return d(),e.addEventListener("scroll",t),()=>e.removeEventListener("scroll",t)}},[l.viewport,m,d]),(0,r.jsx)(P.WV.div,{"data-state":o.hasThumb?"visible":"hidden",...i,ref:c,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:(0,j.M)(e.onPointerDownCapture,e=>{let t=e.target.getBoundingClientRect(),s=e.clientX-t.left,r=e.clientY-t.top;o.onThumbPointerDown({x:s,y:r})}),onPointerUp:(0,j.M)(e.onPointerUp,o.onThumbPointerUp)})});eK.displayName=eH;var eX="ScrollAreaCorner",eQ=a.forwardRef((e,t)=>{let s=ez(eX,e.__scopeScrollArea),a=!!(s.scrollbarX&&s.scrollbarY);return"scroll"!==s.type&&a?(0,r.jsx)(eJ,{...e,ref:t}):null});eQ.displayName=eX;var eJ=a.forwardRef((e,t)=>{let{__scopeScrollArea:s,...n}=e,i=ez(eX,s),[l,o]=a.useState(0),[d,c]=a.useState(0),u=!!(l&&d);return e7(i.scrollbarX,()=>{let e=i.scrollbarX?.offsetHeight||0;i.onCornerHeightChange(e),c(e)}),e7(i.scrollbarY,()=>{let e=i.scrollbarY?.offsetWidth||0;i.onCornerWidthChange(e),o(e)}),u?(0,r.jsx)(P.WV.div,{...n,ref:t,style:{width:l,height:d,position:"absolute",right:"ltr"===i.dir?0:void 0,left:"rtl"===i.dir?0:void 0,bottom:0,...e.style}}):null});function e0(e){return e?parseInt(e,10):0}function e1(e,t){let s=e/t;return isNaN(s)?0:s}function e2(e){let t=e1(e.viewport,e.content),s=e.scrollbar.paddingStart+e.scrollbar.paddingEnd;return Math.max((e.scrollbar.size-s)*t,18)}function e4(e,t,s="ltr"){let r=e2(t),a=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,n=t.scrollbar.size-a,i=t.content-t.viewport,l=(0,eE.u)(e,"ltr"===s?[0,i]:[-1*i,0]);return e6([0,i],[0,n-r])(l)}function e6(e,t){return s=>{if(e[0]===e[1]||t[0]===t[1])return t[0];let r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(s-e[0])}}var e3=(e,t=()=>{})=>{let s={left:e.scrollLeft,top:e.scrollTop},r=0;return function a(){let n={left:e.scrollLeft,top:e.scrollTop},i=s.left!==n.left,l=s.top!==n.top;(i||l)&&t(),s=n,r=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(r)};function e5(e,t){let s=(0,eC.W)(e),r=a.useRef(0);return a.useEffect(()=>()=>window.clearTimeout(r.current),[]),a.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(s,t)},[s,t])}function e7(e,t){let s=(0,eC.W)(t);(0,eS.b)(()=>{let t=0;if(e){let r=new ResizeObserver(()=>{cancelAnimationFrame(t),t=window.requestAnimationFrame(s)});return r.observe(e),()=>{window.cancelAnimationFrame(t),r.unobserve(e)}}},[e,s])}function e8({className:e,children:t,...s}){return(0,r.jsxs)(eR,{"data-slot":"scroll-area",className:(0,h.cn)("relative",e),...s,children:[r.jsx(eI,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:t}),r.jsx(e9,{}),r.jsx(eQ,{})]})}function e9({className:e,orientation:t="vertical",...s}){return r.jsx(e$,{"data-slot":"scroll-area-scrollbar",orientation:t,className:(0,h.cn)("flex touch-none p-px transition-colors select-none","vertical"===t&&"h-full w-2.5 border-l border-l-transparent","horizontal"===t&&"h-2.5 flex-col border-t border-t-transparent",e),...s,children:r.jsx(eK,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}var te=s(63376);function tt({className:e,type:t,...s}){return r.jsx("input",{type:t,"data-slot":"input",className:(0,h.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...s})}var ts=s(94969),tr=s(55633);let ta=(0,l.Z)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),tn=(0,l.Z)("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);var ti=s(76854);let tl=(0,l.Z)("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]),to=(0,l.Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),td=(0,l.Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var tc=s(11534),tu=s(44380);let tm=(0,l.Z)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),th=(0,l.Z)("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),tx=(0,l.Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),tp=(0,l.Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),tg=["M&S","Services","Equipment","Labor","Contractors","Consumables"],tf=["Operational","Maintenance","Capital","Emergency","Planned"],tb=["WIS","Drilling","Production","Facilities","Subsea","FPSO"];function tv({isOpen:e,onClose:t,projectId:s,projectName:n,currentCosts:l,stagedEntries:o,onSave:d,onAddEntry:c,onUpdateEntry:u,onDeleteEntry:h}){let[x,p]=(0,a.useState)("review"),[f,v]=(0,a.useState)({}),[j,y]=(0,a.useState)([]),[w,N]=(0,a.useState)(""),[_,C]=(0,a.useState)(!1),[k,S]=(0,a.useState)(null),[E,P]=(0,a.useState)(!1),[D,T]=(0,a.useState)({sub_business_line:tb[0],cost_line:"",spend_type:"",spend_sub_category:"",budget_cost:0}),M=[{key:"review",label:"Review Budget",icon:r.jsx(ta,{className:"w-4 h-4"})},{key:"modify",label:"Modify Assumptions",icon:r.jsx(tn,{className:"w-4 h-4"})},{key:"add-reason",label:"Add Reason",icon:r.jsx(ti.Z,{className:"w-4 h-4"})},{key:"preview",label:"Preview Changes",icon:r.jsx(tl,{className:"w-4 h-4"})},{key:"confirm",label:"Confirm & Save",icon:r.jsx(g,{className:"w-4 h-4"})}],z=M.findIndex(e=>e.key===x),R=(z+1)/M.length*100,F=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),I=()=>l.reduce((e,t)=>e+t.budget_cost,0),L=()=>l.reduce((e,t)=>{let s=f[t.id];return e+(void 0!==s?s:t.budget_cost)},0)+j.reduce((e,t)=>e+t.budget_cost,0),$=()=>L()-I(),A=()=>{let e=I();return 0===e?0:$()/e*100},V=()=>Object.keys(f).length+j.length,O=async()=>{C(!0);try{await d(f,j,w),localStorage.removeItem(`forecast-draft-${s}`),v({}),y([]),N(""),p("review"),t()}catch(e){console.error("Error saving forecast:",e)}finally{C(!1)}},Z=()=>{if(D.cost_line&&D.spend_type&&D.spend_sub_category&&D.budget_cost){let e=`temp_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;y([...j,{id:e,project_id:s,sub_business_line:D.sub_business_line||tb[0],cost_line:D.cost_line,spend_type:D.spend_type,spend_sub_category:D.spend_sub_category,budget_cost:D.budget_cost,_tempId:e}]),T({sub_business_line:tb[0],cost_line:"",spend_type:"",spend_sub_category:"",budget_cost:0}),P(!1)}},B=e=>{y(j.filter(t=>t.id!==e))},W=()=>{switch(x){case"review":case"preview":case"confirm":return!0;case"modify":return V()>0;case"add-reason":return w.trim().length>0;default:return!1}};return r.jsx(em,{open:e,onOpenChange:t,children:(0,r.jsxs)(eg,{className:"max-w-6xl w-[95vw] h-[90vh] flex flex-col overflow-hidden",children:[(0,r.jsxs)(ef,{className:"flex-shrink-0",children:[(0,r.jsxs)(ev,{children:["Create New Forecast - ",n]}),r.jsx(ej,{children:"Follow the steps to create a new forecast version with tracked changes"})]}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col min-h-0",children:[(0,r.jsxs)("div",{className:"space-y-2 flex-shrink-0 pb-4",children:[r.jsx(eN.E,{value:R,className:"h-2"}),r.jsx("div",{className:"flex justify-between",children:M.map((e,t)=>(0,r.jsxs)("div",{className:`flex items-center gap-1 text-xs ${t<=z?"text-primary font-medium":"text-muted-foreground"}`,children:[t<=z?r.jsx(tm,{className:"w-3 h-3"}):r.jsx(th,{className:"w-3 h-3"}),r.jsx("span",{className:"hidden sm:inline",children:e.label})]},e.key))})]}),r.jsx("div",{className:"flex-1 overflow-y-auto min-h-0",children:(()=>{switch(x){case"review":return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)(e_.bZ,{children:[r.jsx(m.Z,{className:"h-4 w-4"}),r.jsx(e_.X,{children:"Review the current budget before making modifications. This will be your baseline for the forecast."})]}),(0,r.jsxs)(ey.Zb,{children:[r.jsx(ey.Ol,{children:r.jsx(ey.ll,{className:"text-lg",children:"Current Budget Summary"})}),r.jsx(ey.aY,{children:(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Budget"}),r.jsx("p",{className:"text-2xl font-bold",children:F(I())})]}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Line Items"}),r.jsx("p",{className:"text-2xl font-bold",children:l.length})]}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Last Updated"}),r.jsx("p",{className:"text-2xl font-bold",children:"Current"})]})]})})]}),r.jsx(e8,{className:"h-[300px]",children:(0,r.jsxs)(te.iA,{children:[r.jsx(te.xD,{children:(0,r.jsxs)(te.SC,{children:[r.jsx(te.ss,{children:"Cost Line"}),r.jsx(te.ss,{children:"Type"}),r.jsx(te.ss,{children:"Sub Category"}),r.jsx(te.ss,{className:"text-right",children:"Amount"})]})}),r.jsx(te.RM,{children:l.map(e=>(0,r.jsxs)(te.SC,{children:[r.jsx(te.pj,{children:e.cost_line}),r.jsx(te.pj,{children:e.spend_type}),r.jsx(te.pj,{children:e.spend_sub_category}),r.jsx(te.pj,{className:"text-right",children:F(e.budget_cost)})]},e.id))})]})})]});case"modify":return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)(e_.bZ,{children:[r.jsx(tn,{className:"h-4 w-4"}),r.jsx(e_.X,{children:"Modify budget amounts or add new cost items. All changes will be tracked in the forecast version."})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Cost Items"}),!E&&(0,r.jsxs)(b.z,{size:"sm",variant:"outline",onClick:()=>P(!0),children:[r.jsx(to,{className:"w-4 h-4 mr-2"}),"Add New Entry"]})]}),E&&(0,r.jsxs)(ey.Zb,{className:"border-blue-200 bg-blue-50/50",children:[r.jsx(ey.Ol,{children:r.jsx(ey.ll,{className:"text-sm",children:"Add New Cost Entry"})}),(0,r.jsxs)(ey.aY,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx(ts._,{children:"Sub Business Line"}),(0,r.jsxs)(tr.Ph,{value:D.sub_business_line,onValueChange:e=>T({...D,sub_business_line:e}),children:[r.jsx(tr.i4,{children:r.jsx(tr.ki,{})}),r.jsx(tr.Bw,{children:tb.map(e=>r.jsx(tr.Ql,{value:e,children:e},e))})]})]}),(0,r.jsxs)("div",{children:[r.jsx(ts._,{children:"Cost Line"}),(0,r.jsxs)(tr.Ph,{value:D.cost_line,onValueChange:e=>T({...D,cost_line:e}),children:[r.jsx(tr.i4,{children:r.jsx(tr.ki,{placeholder:"Select cost line"})}),r.jsx(tr.Bw,{children:tg.map(e=>r.jsx(tr.Ql,{value:e,children:e},e))})]})]}),(0,r.jsxs)("div",{children:[r.jsx(ts._,{children:"Spend Type"}),(0,r.jsxs)(tr.Ph,{value:D.spend_type,onValueChange:e=>T({...D,spend_type:e}),children:[r.jsx(tr.i4,{children:r.jsx(tr.ki,{placeholder:"Select spend type"})}),r.jsx(tr.Bw,{children:tf.map(e=>r.jsx(tr.Ql,{value:e,children:e},e))})]})]}),(0,r.jsxs)("div",{children:[r.jsx(ts._,{children:"Sub Category"}),r.jsx(tt,{value:D.spend_sub_category,onChange:e=>T({...D,spend_sub_category:e.target.value}),placeholder:"Enter sub category"})]}),(0,r.jsxs)("div",{children:[r.jsx(ts._,{children:"Budget Cost"}),r.jsx(tt,{type:"number",value:D.budget_cost,onChange:e=>T({...D,budget_cost:parseFloat(e.target.value)||0}),placeholder:"0.00"})]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx(b.z,{size:"sm",onClick:Z,children:"Add Entry"}),r.jsx(b.z,{size:"sm",variant:"outline",onClick:()=>{P(!1),T({sub_business_line:tb[0],cost_line:"",spend_type:"",spend_sub_category:"",budget_cost:0})},children:"Cancel"})]})]})]}),r.jsx("div",{className:"relative border rounded-md flex-1 min-h-0",children:r.jsx("div",{className:"h-full max-h-[500px] overflow-auto",children:(0,r.jsxs)(te.iA,{className:"w-full min-w-[800px]",children:[r.jsx(te.xD,{className:"sticky top-0 bg-background z-10 border-b",children:(0,r.jsxs)(te.SC,{children:[r.jsx(te.ss,{className:"whitespace-nowrap",children:"Status"}),r.jsx(te.ss,{className:"whitespace-nowrap",children:"Cost Line"}),r.jsx(te.ss,{className:"whitespace-nowrap",children:"Type"}),r.jsx(te.ss,{className:"whitespace-nowrap",children:"Sub Category"}),r.jsx(te.ss,{className:"text-right whitespace-nowrap",children:"Original"}),r.jsx(te.ss,{className:"text-right whitespace-nowrap",children:"Forecast"}),r.jsx(te.ss,{className:"w-20"})]})}),(0,r.jsxs)(te.RM,{children:[l.map(e=>{let t=k===e.id,s=void 0!==f[e.id],a=f[e.id]??e.budget_cost;return(0,r.jsxs)(te.SC,{children:[r.jsx(te.pj,{className:"whitespace-nowrap",children:s&&r.jsx(i.C,{variant:"outline",className:"text-xs",children:"Modified"})}),r.jsx(te.pj,{className:"whitespace-nowrap",children:e.cost_line}),r.jsx(te.pj,{className:"whitespace-nowrap",children:e.spend_type}),r.jsx(te.pj,{className:"whitespace-nowrap truncate max-w-[150px]",title:e.spend_sub_category,children:e.spend_sub_category}),r.jsx(te.pj,{className:"text-right whitespace-nowrap",children:F(e.budget_cost)}),r.jsx(te.pj,{className:"text-right whitespace-nowrap p-1",children:t?r.jsx(tt,{type:"number",value:a,onChange:t=>v({...f,[e.id]:parseFloat(t.target.value)||0}),className:"w-28 text-right text-sm",autoFocus:!0,onBlur:()=>S(null),onKeyDown:e=>{"Enter"===e.key&&S(null)}}):r.jsx("button",{onClick:()=>S(e.id),className:"hover:underline text-right w-full",children:F(a)})}),r.jsx(te.pj,{className:"p-1",children:s&&r.jsx(b.z,{size:"sm",variant:"ghost",className:"h-8 px-2 text-xs",onClick:()=>{let{[e.id]:t,...s}=f;v(s)},children:"Reset"})})]},e.id)}),j.map(e=>(0,r.jsxs)(te.SC,{className:"bg-amber-50/50",children:[r.jsx(te.pj,{className:"whitespace-nowrap",children:r.jsx(i.C,{className:"text-xs bg-amber-500",children:"New"})}),r.jsx(te.pj,{className:"whitespace-nowrap",children:e.cost_line}),r.jsx(te.pj,{className:"whitespace-nowrap",children:e.spend_type}),r.jsx(te.pj,{className:"whitespace-nowrap truncate max-w-[150px]",title:e.spend_sub_category,children:e.spend_sub_category}),r.jsx(te.pj,{className:"text-right whitespace-nowrap",children:"-"}),r.jsx(te.pj,{className:"text-right whitespace-nowrap",children:F(e.budget_cost)}),r.jsx(te.pj,{className:"p-1",children:r.jsx(b.z,{size:"sm",variant:"ghost",className:"h-8 px-2",onClick:()=>B(e.id),children:r.jsx(td,{className:"w-3 h-3"})})})]},e.id))]})]})})}),r.jsx(ey.Zb,{className:"bg-gray-50",children:r.jsx(ey.aY,{className:"pt-6",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Total Changes: ",V()," items"]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"New Total:"}),r.jsx("span",{className:"text-lg font-bold",children:F(L())}),0!==$()&&(0,r.jsxs)(i.C,{variant:$()>0?"default":"destructive",className:"ml-2",children:[$()>0?"+":"",F($())]})]})]})})})]});case"add-reason":return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)(e_.bZ,{children:[r.jsx(ti.Z,{className:"h-4 w-4"}),r.jsx(e_.X,{children:"Provide a clear reason for this forecast. This will be stored with the version for future reference."})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(ts._,{htmlFor:"reason",children:"Reason for Forecast"}),r.jsx(ew.g,{id:"reason",value:w,onChange:e=>N(e.target.value),placeholder:"Explain the business rationale for these changes...",className:"min-h-[200px]"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:'Be specific about what drove these changes (e.g., "Q3 market conditions require additional equipment maintenance budget")'})]}),(0,r.jsxs)(ey.Zb,{children:[r.jsx(ey.Ol,{children:r.jsx(ey.ll,{className:"text-sm",children:"Change Summary"})}),r.jsx(ey.aY,{children:(0,r.jsxs)("dl",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,r.jsxs)("div",{children:[r.jsx("dt",{className:"text-muted-foreground",children:"Items Modified"}),(0,r.jsxs)("dd",{className:"font-semibold",children:[Object.keys(f).length," existing"]})]}),(0,r.jsxs)("div",{children:[r.jsx("dt",{className:"text-muted-foreground",children:"Items Added"}),(0,r.jsxs)("dd",{className:"font-semibold",children:[j.length," new"]})]}),(0,r.jsxs)("div",{children:[r.jsx("dt",{className:"text-muted-foreground",children:"Total Change"}),(0,r.jsxs)("dd",{className:"font-semibold",children:[$()>0?"+":"",F($())]})]}),(0,r.jsxs)("div",{children:[r.jsx("dt",{className:"text-muted-foreground",children:"Change %"}),(0,r.jsxs)("dd",{className:"font-semibold",children:[A()>0?"+":"",A().toFixed(1),"%"]})]})]})})]})]});case"preview":return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)(e_.bZ,{children:[r.jsx(tl,{className:"h-4 w-4"}),r.jsx(e_.X,{children:"Review all changes before saving. This will create a new forecast version."})]}),(0,r.jsxs)(ey.Zb,{children:[(0,r.jsxs)(ey.Ol,{children:[r.jsx(ey.ll,{children:"Forecast Summary"}),r.jsx(ey.SZ,{children:w})]}),(0,r.jsxs)(ey.aY,{children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"font-semibold mb-2",children:"Before"}),(0,r.jsxs)("dl",{className:"space-y-1 text-sm",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("dt",{className:"text-muted-foreground",children:"Total Budget"}),r.jsx("dd",{children:F(I())})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("dt",{className:"text-muted-foreground",children:"Line Items"}),r.jsx("dd",{children:l.length})]})]})]}),(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"font-semibold mb-2",children:"After"}),(0,r.jsxs)("dl",{className:"space-y-1 text-sm",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("dt",{className:"text-muted-foreground",children:"Total Forecast"}),r.jsx("dd",{className:"font-semibold",children:F(L())})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("dt",{className:"text-muted-foreground",children:"Line Items"}),r.jsx("dd",{className:"font-semibold",children:l.length+j.length})]})]})]})]}),r.jsx("div",{className:"mt-4 pt-4 border-t",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[$()>=0?r.jsx(tc.Z,{className:"w-4 h-4 text-green-600"}):r.jsx(tu.Z,{className:"w-4 h-4 text-red-600"}),r.jsx("span",{className:"font-semibold",children:"Total Change:"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("span",{className:`text-lg font-bold ${$()>=0?"text-green-600":"text-red-600"}`,children:[$()>0?"+":"",F($())]}),(0,r.jsxs)(i.C,{variant:"outline",children:[A()>0?"+":"",A().toFixed(1),"%"]})]})]})})]})]}),Object.keys(f).length>0&&(0,r.jsxs)(ey.Zb,{children:[r.jsx(ey.Ol,{children:r.jsx(ey.ll,{className:"text-sm",children:"Modified Items"})}),r.jsx(ey.aY,{children:r.jsx(e8,{className:"h-[200px]",children:r.jsx("div",{className:"space-y-2",children:Object.entries(f).map(([e,t])=>{let s=l.find(t=>t.id===e);if(!s)return null;let a=t-s.budget_cost;return(0,r.jsxs)("div",{className:"flex justify-between items-center text-sm py-1",children:[(0,r.jsxs)("span",{className:"text-muted-foreground",children:[s.cost_line," - ",s.spend_sub_category]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-muted-foreground",children:F(s.budget_cost)}),r.jsx("span",{children:"â†’"}),r.jsx("span",{className:"font-semibold",children:F(t)}),(0,r.jsxs)(i.C,{variant:a>0?"default":"destructive",className:"text-xs",children:[a>0?"+":"",F(a)]})]})]},e)})})})})]}),j.length>0&&(0,r.jsxs)(ey.Zb,{children:[r.jsx(ey.Ol,{children:r.jsx(ey.ll,{className:"text-sm",children:"New Items"})}),r.jsx(ey.aY,{children:r.jsx(e8,{className:"h-[200px]",children:r.jsx("div",{className:"space-y-2",children:j.map(e=>(0,r.jsxs)("div",{className:"flex justify-between items-center text-sm py-1",children:[(0,r.jsxs)("span",{className:"text-muted-foreground",children:[e.cost_line," - ",e.spend_sub_category]}),r.jsx("span",{className:"font-semibold",children:F(e.budget_cost)})]},e.id))})})})]})]});case"confirm":return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)(e_.bZ,{className:"border-green-200 bg-green-50",children:[r.jsx(tm,{className:"h-4 w-4 text-green-600"}),r.jsx(e_.X,{className:"text-green-800",children:"Your forecast is ready to be saved. This will create a new version that can be reviewed and compared with previous versions."})]}),r.jsx(ey.Zb,{children:r.jsx(ey.aY,{className:"pt-6",children:(0,r.jsxs)("div",{className:"text-center space-y-4",children:[r.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto",children:r.jsx(tm,{className:"w-8 h-8 text-green-600"})}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Ready to Save Forecast"}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:["Version will be created with ",V()," changes"]})]}),(0,r.jsxs)("div",{className:"pt-4 space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{className:"text-muted-foreground",children:"New Total:"}),r.jsx("span",{className:"font-semibold",children:F(L())})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{className:"text-muted-foreground",children:"Change:"}),(0,r.jsxs)("span",{className:`font-semibold ${$()>=0?"text-green-600":"text-red-600"}`,children:[$()>0?"+":"",F($())," (",A()>0?"+":"",A().toFixed(1),"%)"]})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{className:"text-muted-foreground",children:"Reason:"}),r.jsx("span",{className:"font-semibold text-right max-w-[200px] truncate",children:w})]})]})]})})})]});default:return null}})()})]}),(0,r.jsxs)(eb,{className:"flex justify-between flex-shrink-0 mt-4",children:[r.jsx("div",{className:"flex gap-2",children:z>0&&(0,r.jsxs)(b.z,{variant:"outline",onClick:()=>{let e=M.findIndex(e=>e.key===x);e>0&&p(M[e-1].key)},disabled:_,children:[r.jsx(tx,{className:"w-4 h-4 mr-2"}),"Back"]})}),(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx(b.z,{variant:"outline",onClick:t,disabled:_,children:"Cancel"}),"confirm"===x?r.jsx(b.z,{onClick:O,disabled:_||!W(),children:_?"Saving...":"Save Forecast"}):(0,r.jsxs)(b.z,{onClick:()=>{let e=M.findIndex(e=>e.key===x);e<M.length-1&&p(M[e+1].key)},disabled:!W(),children:["Next",r.jsx(tp,{className:"w-4 h-4 ml-2"})]})]})]})]})})}var tj=s(96677);let ty=(0,l.Z)("GitCompare",[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["path",{d:"M11 18H8a2 2 0 0 1-2-2V9",key:"19pyzm"}]]),tw=(0,l.Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var tN=s(54744);let t_=(0,l.Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);function tC({versions:e,currentVersion:t,onVersionSelect:s,onCompareVersions:n,costBreakdowns:l,isLoading:d}){let[c,u]=(0,a.useState)(!1),[m,h]=(0,a.useState)(null),[x,p]=(0,a.useState)(null),[g,f]=(0,a.useState)(null),v=[...e].sort((e,t)=>t.version_number-e.version_number),j=e=>{let t=Date.now()-new Date(e.created_at).getTime();return t<864e5?{label:"New",variant:"default"}:t<6048e5?{label:"Recent",variant:"secondary"}:t<2592e6?{label:"Current",variant:"outline"}:{label:"Historical",variant:"outline"}},y=e=>{if(!l||0===e)return{totalChange:0,changePercent:0,itemsChanged:0};let t=l[e]||[],s=l[e-1]||[],r=0,a=0;t.forEach(e=>{let t=s.find(t=>t.id===e.id);if(t){let s=(e.forecasted_cost||e.budget_cost)-(t.forecasted_cost||t.budget_cost);0!==s&&(r+=s,a++)}else r+=e.forecasted_cost||e.budget_cost,a++});let n=s.reduce((e,t)=>e+(t.forecasted_cost||t.budget_cost),0),i=n>0?r/n*100:0;return{totalChange:r,changePercent:i,itemsChanged:a}},w=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e);return d?r.jsx(ey.Zb,{children:r.jsx(ey.aY,{className:"p-6",children:(0,r.jsxs)("div",{className:"animate-pulse space-y-4",children:[r.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3"}),r.jsx("div",{className:"h-20 bg-gray-200 rounded"}),r.jsx("div",{className:"h-20 bg-gray-200 rounded"})]})})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(ey.Zb,{children:[r.jsx(ey.Ol,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx(ey.ll,{children:"Version History"}),r.jsx(ey.SZ,{children:"Track changes and evolution of budget assumptions"})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)(b.z,{variant:"outline",size:"sm",onClick:()=>u(!0),disabled:e.length<2,children:[r.jsx(ty,{className:"w-4 h-4 mr-2"}),"Compare"]}),(0,r.jsxs)(b.z,{variant:"outline",size:"sm",onClick:()=>{},children:[r.jsx(tw,{className:"w-4 h-4 mr-2"}),"Export"]})]})]})}),r.jsx(ey.aY,{children:r.jsx(e8,{className:"h-[500px] pr-4",children:(0,r.jsxs)("div",{className:"relative",children:[r.jsx("div",{className:"absolute left-9 top-0 bottom-0 w-0.5 bg-gray-200"}),v.map((e,a)=>{let n=y(e.version_number),d=j(e),c=t===e.version_number||"latest"===t&&0===a,u=g===e.id;return(0,r.jsxs)("div",{className:"relative flex gap-4 pb-8",children:[r.jsx("div",{className:`
                        relative z-10 flex items-center justify-center w-10 h-10 rounded-full
                        ${c?"bg-blue-600 text-white":"bg-white border-2 border-gray-300 text-gray-600"}
                      `,children:r.jsx("span",{className:"text-sm font-semibold",children:0===e.version_number?"Init":`v${e.version_number}`})}),r.jsx("div",{className:"flex-1",children:r.jsx(ey.Zb,{className:`
                          cursor-pointer transition-all hover:shadow-md
                          ${c?"ring-2 ring-blue-600 ring-offset-2":""}
                        `,onClick:()=>f(u?null:e.id),children:(0,r.jsxs)(ey.aY,{className:"p-4",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("h4",{className:"font-semibold text-sm",children:0===e.version_number?"Initial Budget":`Version ${e.version_number}`}),r.jsx(i.C,{variant:d.variant,children:d.label}),c&&r.jsx(i.C,{variant:"default",className:"bg-blue-600",children:"Current"})]}),r.jsx(b.z,{variant:"ghost",size:"sm",onClick:t=>{t.stopPropagation(),s(e.version_number)},children:r.jsx(ta,{className:"w-4 h-4"})})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-600 mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[r.jsx(tN.Z,{className:"w-3 h-3"}),(0,tj.WU)(new Date(e.created_at),"MMM d, yyyy")]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[r.jsx(o,{className:"w-3 h-3"}),(0,tj.WU)(new Date(e.created_at),"h:mm a")]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[r.jsx(t_,{className:"w-3 h-3"}),e.created_by]})]}),r.jsx("div",{className:"mb-3",children:(0,r.jsxs)("p",{className:"text-sm text-gray-700",children:[r.jsx(ti.Z,{className:"w-3 h-3 inline mr-1"}),e.reason_for_change]})}),e.version_number>0&&(0,r.jsxs)("div",{className:"flex items-center gap-4 pt-3 border-t",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[n.totalChange>=0?r.jsx(tc.Z,{className:"w-4 h-4 text-green-600"}):r.jsx(tu.Z,{className:"w-4 h-4 text-red-600"}),r.jsx("span",{className:`text-sm font-medium ${n.totalChange>=0?"text-green-600":"text-red-600"}`,children:w(Math.abs(n.totalChange))})]}),r.jsx("div",{className:"text-xs text-gray-600",children:0!==n.changePercent&&(0,r.jsxs)("span",{children:["(",n.changePercent>0?"+":"",n.changePercent.toFixed(1),"%)"]})}),(0,r.jsxs)("div",{className:"text-xs text-gray-600",children:[n.itemsChanged," items changed"]})]}),u&&l?.[e.version_number]&&(0,r.jsxs)("div",{className:"mt-4 pt-4 border-t",children:[r.jsx("h5",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Top Changes"}),r.jsx("div",{className:"space-y-1",children:l[e.version_number].slice(0,3).map(e=>(0,r.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,r.jsxs)("span",{className:"text-gray-600",children:[e.cost_line," - ",e.spend_sub_category]}),r.jsx("span",{className:"font-medium",children:w(e.forecasted_cost||e.budget_cost)})]},e.id))})]})]})})})]},e.id)})]})})})]}),r.jsx(em,{open:c,onOpenChange:e=>{u(e),e||(h(null),p(null),console.log("[VersionComparison] Dialog state reset:",{isOpen:e,compareFrom:null,compareTo:null,timestamp:Date.now()}))},children:(0,r.jsxs)(eg,{className:"sm:max-w-[600px]",children:[(0,r.jsxs)(ef,{children:[r.jsx(ev,{children:"Compare Versions"}),r.jsx(ej,{children:"Select two versions to see the differences between them"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 py-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"text-sm font-medium",children:"From Version"}),(0,r.jsxs)("select",{className:"w-full mt-1 px-3 py-2 border rounded-md",value:null!==m?m:"",onChange:e=>h(e.target.value?Number(e.target.value):null),"aria-label":"Select from version","aria-describedby":"version-from-helper",children:[r.jsx("option",{value:"",children:"Select version"}),v.map(e=>(0,r.jsxs)("option",{value:e.version_number,children:["Version ",e.version_number]},e.id))]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"text-sm font-medium",children:"To Version"}),(0,r.jsxs)("select",{className:"w-full mt-1 px-3 py-2 border rounded-md",value:null!==x?x:"",onChange:e=>p(e.target.value?Number(e.target.value):null),children:[r.jsx("option",{value:"",children:"Select version"}),v.filter(e=>null===m||e.version_number!==m).map(e=>(0,r.jsxs)("option",{value:e.version_number,children:["Version ",e.version_number]},e.id))]})]})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[r.jsx(b.z,{variant:"outline",onClick:()=>u(!1),children:"Cancel"}),(0,r.jsxs)(b.z,{onClick:()=>{null!==m&&null!==x&&n&&(n(m,x),u(!1))},disabled:null===m||null===x,children:[r.jsx(ty,{className:"w-4 h-4 mr-2"}),"Compare"]})]})]})})]})}function tk({...e}){return r.jsx(A,{"data-slot":"sheet",...e})}function tS({...e}){return r.jsx(U,{"data-slot":"sheet-portal",...e})}function tE({className:e,...t}){return r.jsx(Y,{"data-slot":"sheet-overlay",className:(0,h.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function tP({className:e,children:t,side:s="right",...a}){return(0,r.jsxs)(tS,{children:[r.jsx(tE,{}),(0,r.jsxs)(G,{"data-slot":"sheet-content",className:(0,h.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500","right"===s&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm","left"===s&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm","top"===s&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b","bottom"===s&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",e),...a,children:[t,(0,r.jsxs)(en,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",children:[r.jsx(f.Z,{className:"size-4"}),r.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function tD({className:e,...t}){return r.jsx("div",{"data-slot":"sheet-header",className:(0,h.cn)("flex flex-col gap-1.5 p-4",e),...t})}function tT({className:e,...t}){return r.jsx(et,{"data-slot":"sheet-title",className:(0,h.cn)("text-foreground font-semibold",e),...t})}function tM({className:e,...t}){return r.jsx(er,{"data-slot":"sheet-description",className:(0,h.cn)("text-muted-foreground text-sm",e),...t})}var tz=s(84290),tR="rovingFocusGroup.onEntryFocus",tF={bubbles:!1,cancelable:!0},tI="RovingFocusGroup",[tL,t$,tA]=(0,tz.B)(tI),[tV,tO]=(0,w.b)(tI,[tA]),[tZ,tB]=tV(tI),tW=a.forwardRef((e,t)=>(0,r.jsx)(tL.Provider,{scope:e.__scopeRovingFocusGroup,children:(0,r.jsx)(tL.Slot,{scope:e.__scopeRovingFocusGroup,children:(0,r.jsx)(tU,{...e,ref:t})})}));tW.displayName=tI;var tU=a.forwardRef((e,t)=>{let{__scopeRovingFocusGroup:s,orientation:n,loop:i=!1,dir:l,currentTabStopId:o,defaultCurrentTabStopId:d,onCurrentTabStopIdChange:c,onEntryFocus:u,preventScrollOnEntryFocus:m=!1,...h}=e,x=a.useRef(null),p=(0,y.e)(t,x),g=(0,ek.gm)(l),[f=null,b]=(0,_.T)({prop:o,defaultProp:d,onChange:c}),[v,w]=a.useState(!1),N=(0,eC.W)(u),C=t$(s),k=a.useRef(!1),[S,E]=a.useState(0);return a.useEffect(()=>{let e=x.current;if(e)return e.addEventListener(tR,N),()=>e.removeEventListener(tR,N)},[N]),(0,r.jsx)(tZ,{scope:s,orientation:n,dir:g,loop:i,currentTabStopId:f,onItemFocus:a.useCallback(e=>b(e),[b]),onItemShiftTab:a.useCallback(()=>w(!0),[]),onFocusableItemAdd:a.useCallback(()=>E(e=>e+1),[]),onFocusableItemRemove:a.useCallback(()=>E(e=>e-1),[]),children:(0,r.jsx)(P.WV.div,{tabIndex:v||0===S?-1:0,"data-orientation":n,...h,ref:p,style:{outline:"none",...e.style},onMouseDown:(0,j.M)(e.onMouseDown,()=>{k.current=!0}),onFocus:(0,j.M)(e.onFocus,e=>{let t=!k.current;if(e.target===e.currentTarget&&t&&!v){let t=new CustomEvent(tR,tF);if(e.currentTarget.dispatchEvent(t),!t.defaultPrevented){let e=C().filter(e=>e.focusable);tK([e.find(e=>e.active),e.find(e=>e.id===f),...e].filter(Boolean).map(e=>e.ref.current),m)}}k.current=!1}),onBlur:(0,j.M)(e.onBlur,()=>w(!1))})})}),tq="RovingFocusGroupItem",tY=a.forwardRef((e,t)=>{let{__scopeRovingFocusGroup:s,focusable:n=!0,active:i=!1,tabStopId:l,...o}=e,d=(0,N.M)(),c=l||d,u=tB(tq,s),m=u.currentTabStopId===c,h=t$(s),{onFocusableItemAdd:x,onFocusableItemRemove:p}=u;return a.useEffect(()=>{if(n)return x(),()=>p()},[n,x,p]),(0,r.jsx)(tL.ItemSlot,{scope:s,id:c,focusable:n,active:i,children:(0,r.jsx)(P.WV.span,{tabIndex:m?0:-1,"data-orientation":u.orientation,...o,ref:t,onMouseDown:(0,j.M)(e.onMouseDown,e=>{n?u.onItemFocus(c):e.preventDefault()}),onFocus:(0,j.M)(e.onFocus,()=>u.onItemFocus(c)),onKeyDown:(0,j.M)(e.onKeyDown,e=>{if("Tab"===e.key&&e.shiftKey){u.onItemShiftTab();return}if(e.target!==e.currentTarget)return;let t=function(e,t,s){var r;let a=(r=e.key,"rtl"!==s?r:"ArrowLeft"===r?"ArrowRight":"ArrowRight"===r?"ArrowLeft":r);if(!("vertical"===t&&["ArrowLeft","ArrowRight"].includes(a))&&!("horizontal"===t&&["ArrowUp","ArrowDown"].includes(a)))return tH[a]}(e,u.orientation,u.dir);if(void 0!==t){if(e.metaKey||e.ctrlKey||e.altKey||e.shiftKey)return;e.preventDefault();let s=h().filter(e=>e.focusable).map(e=>e.ref.current);if("last"===t)s.reverse();else if("prev"===t||"next"===t){"prev"===t&&s.reverse();let r=s.indexOf(e.currentTarget);s=u.loop?function(e,t){return e.map((s,r)=>e[(t+r)%e.length])}(s,r+1):s.slice(r+1)}setTimeout(()=>tK(s))}})})})});tY.displayName=tq;var tH={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function tK(e,t=!1){let s=document.activeElement;for(let r of e)if(r===s||(r.focus({preventScroll:t}),document.activeElement!==s))return}var tG=a.forwardRef((e,t)=>{let{pressed:s,defaultPressed:a=!1,onPressedChange:n,...i}=e,[l=!1,o]=(0,_.T)({prop:s,onChange:n,defaultProp:a});return(0,r.jsx)(P.WV.button,{type:"button","aria-pressed":l,"data-state":l?"on":"off","data-disabled":e.disabled?"":void 0,...i,ref:t,onClick:(0,j.M)(e.onClick,()=>{e.disabled||o(!l)})})});tG.displayName="Toggle";var tX="ToggleGroup",[tQ,tJ]=(0,w.b)(tX,[tO]),t0=tO(),t1=a.forwardRef((e,t)=>{let{type:s,...a}=e;if("single"===s)return(0,r.jsx)(t6,{...a,ref:t});if("multiple"===s)return(0,r.jsx)(t3,{...a,ref:t});throw Error(`Missing prop \`type\` expected on \`${tX}\``)});t1.displayName=tX;var[t2,t4]=tQ(tX),t6=a.forwardRef((e,t)=>{let{value:s,defaultValue:n,onValueChange:i=()=>{},...l}=e,[o,d]=(0,_.T)({prop:s,defaultProp:n,onChange:i});return(0,r.jsx)(t2,{scope:e.__scopeToggleGroup,type:"single",value:o?[o]:[],onItemActivate:d,onItemDeactivate:a.useCallback(()=>d(""),[d]),children:(0,r.jsx)(t8,{...l,ref:t})})}),t3=a.forwardRef((e,t)=>{let{value:s,defaultValue:n,onValueChange:i=()=>{},...l}=e,[o=[],d]=(0,_.T)({prop:s,defaultProp:n,onChange:i}),c=a.useCallback(e=>d((t=[])=>[...t,e]),[d]),u=a.useCallback(e=>d((t=[])=>t.filter(t=>t!==e)),[d]);return(0,r.jsx)(t2,{scope:e.__scopeToggleGroup,type:"multiple",value:o,onItemActivate:c,onItemDeactivate:u,children:(0,r.jsx)(t8,{...l,ref:t})})});t1.displayName=tX;var[t5,t7]=tQ(tX),t8=a.forwardRef((e,t)=>{let{__scopeToggleGroup:s,disabled:a=!1,rovingFocus:n=!0,orientation:i,dir:l,loop:o=!0,...d}=e,c=t0(s),u=(0,ek.gm)(l),m={role:"group",dir:u,...d};return(0,r.jsx)(t5,{scope:s,rovingFocus:n,disabled:a,children:n?(0,r.jsx)(tW,{asChild:!0,...c,orientation:i,dir:u,loop:o,children:(0,r.jsx)(P.WV.div,{...m,ref:t})}):(0,r.jsx)(P.WV.div,{...m,ref:t})})}),t9="ToggleGroupItem",se=a.forwardRef((e,t)=>{let s=t4(t9,e.__scopeToggleGroup),n=t7(t9,e.__scopeToggleGroup),i=t0(e.__scopeToggleGroup),l=s.value.includes(e.value),o=n.disabled||e.disabled,d={...e,pressed:l,disabled:o},c=a.useRef(null);return n.rovingFocus?(0,r.jsx)(tY,{asChild:!0,...i,focusable:!o,active:l,ref:c,children:(0,r.jsx)(st,{...d,ref:t})}):(0,r.jsx)(st,{...d,ref:t})});se.displayName=t9;var st=a.forwardRef((e,t)=>{let{__scopeToggleGroup:s,value:a,...n}=e,i=t4(t9,s),l={role:"radio","aria-checked":e.pressed,"aria-pressed":void 0},o="single"===i.type?l:void 0;return(0,r.jsx)(tG,{...o,...n,ref:t,onPressedChange:e=>{e?i.onItemActivate(a):i.onItemDeactivate(a)}})});let ss=(0,s(84766).j)("inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium hover:bg-muted hover:text-muted-foreground disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 [&_svg]:shrink-0 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] outline-none transition-[color,box-shadow] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive whitespace-nowrap",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent shadow-xs hover:bg-accent hover:text-accent-foreground"},size:{default:"h-9 px-2 min-w-9",sm:"h-8 px-1.5 min-w-8",lg:"h-10 px-2.5 min-w-10"}},defaultVariants:{variant:"default",size:"default"}}),sr=a.createContext({size:"default",variant:"default"});function sa({className:e,variant:t,size:s,children:a,...n}){return r.jsx(t1,{"data-slot":"toggle-group","data-variant":t,"data-size":s,className:(0,h.cn)("group/toggle-group flex w-fit items-center rounded-md data-[variant=outline]:shadow-xs",e),...n,children:r.jsx(sr.Provider,{value:{variant:t,size:s},children:a})})}function sn({className:e,children:t,variant:s,size:n,...i}){let l=a.useContext(sr);return r.jsx(se,{"data-slot":"toggle-group-item","data-variant":l.variant||s,"data-size":l.size||n,className:(0,h.cn)(ss({variant:l.variant||s,size:l.size||n}),"min-w-0 flex-1 shrink-0 rounded-none shadow-none first:rounded-l-md last:rounded-r-md focus:z-10 focus-visible:z-10 data-[variant=outline]:border-l-0 data-[variant=outline]:first:border-l",e),...i,children:t})}var si="Tabs",[sl,so]=(0,w.b)(si,[tO]),sd=tO(),[sc,su]=sl(si),sm=a.forwardRef((e,t)=>{let{__scopeTabs:s,value:a,onValueChange:n,defaultValue:i,orientation:l="horizontal",dir:o,activationMode:d="automatic",...c}=e,u=(0,ek.gm)(o),[m,h]=(0,_.T)({prop:a,onChange:n,defaultProp:i});return(0,r.jsx)(sc,{scope:s,baseId:(0,N.M)(),value:m,onValueChange:h,orientation:l,dir:u,activationMode:d,children:(0,r.jsx)(P.WV.div,{dir:u,"data-orientation":l,...c,ref:t})})});sm.displayName=si;var sh="TabsList",sx=a.forwardRef((e,t)=>{let{__scopeTabs:s,loop:a=!0,...n}=e,i=su(sh,s),l=sd(s);return(0,r.jsx)(tW,{asChild:!0,...l,orientation:i.orientation,dir:i.dir,loop:a,children:(0,r.jsx)(P.WV.div,{role:"tablist","aria-orientation":i.orientation,...n,ref:t})})});sx.displayName=sh;var sp="TabsTrigger",sg=a.forwardRef((e,t)=>{let{__scopeTabs:s,value:a,disabled:n=!1,...i}=e,l=su(sp,s),o=sd(s),d=sv(l.baseId,a),c=sj(l.baseId,a),u=a===l.value;return(0,r.jsx)(tY,{asChild:!0,...o,focusable:!n,active:u,children:(0,r.jsx)(P.WV.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":c,"data-state":u?"active":"inactive","data-disabled":n?"":void 0,disabled:n,id:d,...i,ref:t,onMouseDown:(0,j.M)(e.onMouseDown,e=>{n||0!==e.button||!1!==e.ctrlKey?e.preventDefault():l.onValueChange(a)}),onKeyDown:(0,j.M)(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&l.onValueChange(a)}),onFocus:(0,j.M)(e.onFocus,()=>{let e="manual"!==l.activationMode;u||n||!e||l.onValueChange(a)})})})});sg.displayName=sp;var sf="TabsContent",sb=a.forwardRef((e,t)=>{let{__scopeTabs:s,value:n,forceMount:i,children:l,...o}=e,d=su(sf,s),c=sv(d.baseId,n),u=sj(d.baseId,n),m=n===d.value,h=a.useRef(m);return a.useEffect(()=>{let e=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,r.jsx)(E.z,{present:i||m,children:({present:s})=>(0,r.jsx)(P.WV.div,{"data-state":m?"active":"inactive","data-orientation":d.orientation,role:"tabpanel","aria-labelledby":c,hidden:!s,id:u,tabIndex:0,...o,ref:t,style:{...e.style,animationDuration:h.current?"0s":void 0},children:s&&l})})});function sv(e,t){return`${e}-trigger-${t}`}function sj(e,t){return`${e}-content-${t}`}function sy({className:e,...t}){return r.jsx(sm,{"data-slot":"tabs",className:(0,h.cn)("flex flex-col gap-2",e),...t})}function sw({className:e,...t}){return r.jsx(sx,{"data-slot":"tabs-list",className:(0,h.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",e),...t})}function sN({className:e,...t}){return r.jsx(sg,{"data-slot":"tabs-trigger",className:(0,h.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}function s_({className:e,...t}){return r.jsx(sb,{"data-slot":"tabs-content",className:(0,h.cn)("flex-1 outline-none",e),...t})}sb.displayName=sf;var sC=s(38723),sk=s(56810),sS=s(6589),sE=s(54126),sP=s(30707),sD=s(62796),sT=s(32901),sM=(0,sS.z)({chartName:"BarChart",GraphicalChild:sE.$,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:sP.K},{axisType:"yAxis",AxisComp:sD.B}],formatAxisMap:sT.t9}),sz=s(28969),sR=s(65916),sF=s(65421),sI=s(47939),sL=s(7677);function s$({data:e,title:t="Budget Change Waterfall",description:s}){let n=(0,a.useMemo)(()=>{console.log("[Charts] WaterfallChart rendering:",{inputData:e,dataLength:e.length,timestamp:Date.now()});let t=new Map;e.forEach(e=>{let s=t.get(e.category)||0;t.set(e.category,s+e.change)});let s=[],r=e.reduce((e,t)=>e+(t.v1_amount||0),0);return s.push({name:"Start",value:r,displayValue:r,fill:"#6366f1",isTotal:!0}),Array.from(t.entries()).forEach(([e,t])=>{if(0!==t){let a=r;r+=t,s.push({name:e,value:t>0?[a,r]:[r,a],displayValue:Math.abs(t),actualChange:t,fill:t>0?"#22c55e":"#ef4444",isTotal:!1})}}),s.push({name:"End",value:r,displayValue:r,fill:"#6366f1",isTotal:!0}),s},[e]),i=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(Math.abs(e));return(0,r.jsxs)(ey.Zb,{children:[(0,r.jsxs)(ey.Ol,{children:[r.jsx(ey.ll,{children:t}),s&&r.jsx(ey.SZ,{children:s})]}),r.jsx(ey.aY,{children:r.jsx(sk.h,{width:"100%",height:400,children:(0,r.jsxs)(sM,{data:n,margin:{top:20,right:30,left:20,bottom:60},children:[r.jsx(sz.q,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),r.jsx(sP.K,{dataKey:"name",angle:-45,textAnchor:"end",height:100,tick:{fontSize:11}}),r.jsx(sD.B,{tickFormatter:e=>`$${(e/1e3).toFixed(0)}K`,tick:{fontSize:11}}),r.jsx(sR.u,{content:r.jsx(({active:e,payload:t})=>{if(e&&t&&t[0]){let e=t[0].payload;return(0,r.jsxs)("div",{className:"bg-white p-3 border border-gray-200 rounded-lg shadow-lg",children:[r.jsx("p",{className:"font-medium text-sm",children:e.name}),(0,r.jsxs)("p",{className:`text-sm font-semibold ${e.isTotal?"text-blue-600":e.actualChange>0?"text-green-600":"text-red-600"}`,children:[e.isTotal?"Total: ":e.actualChange>0?"+":"-",i(e.displayValue)]})]})}return null},{})}),r.jsx(sE.$,{dataKey:"value",shape:e=>{let{fill:t,x:s,y:a,width:n,height:i,payload:l}=e;return l.isTotal,r.jsx("rect",{x:s,y:a,width:n,height:i,fill:t,rx:4})},isAnimationActive:!1,children:n.map((e,t)=>r.jsx(sF.b,{fill:e.fill},`cell-${t}`))})]})})})]})}function sA({data:e}){let t=(0,a.useMemo)(()=>(console.log("[Charts] CategoryComparison data:",{inputData:e,dataLength:e.length,timestamp:Date.now()}),e.map(e=>({...e,changePercent:e.changePercent||0,changeColor:e.change>0?"#22c55e":e.change<0?"#ef4444":"#94a3b8"}))),[e]);return(0,r.jsxs)(ey.Zb,{children:[(0,r.jsxs)(ey.Ol,{children:[r.jsx(ey.ll,{children:"Category-Level Comparison"}),r.jsx(ey.SZ,{children:"Budget changes by business line"})]}),r.jsx(ey.aY,{children:r.jsx(sk.h,{width:"100%",height:350,children:(0,r.jsxs)(sI.c,{data:t,margin:{top:20,right:30,left:20,bottom:60},children:[r.jsx(sz.q,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),r.jsx(sP.K,{dataKey:"category",angle:-45,textAnchor:"end",height:100,tick:{fontSize:11}}),r.jsx(sD.B,{yAxisId:"amount",tickFormatter:e=>`$${(e/1e3).toFixed(0)}K`,tick:{fontSize:11}}),r.jsx(sD.B,{yAxisId:"percent",orientation:"right",tickFormatter:e=>`${e}%`,tick:{fontSize:11}}),r.jsx(sR.u,{formatter:(e,t)=>"Change %"===t?`${e.toFixed(1)}%`:`$${(e/1e3).toFixed(1)}K`}),r.jsx(sE.$,{yAxisId:"amount",dataKey:"v1_total",fill:"#cbd5e1",name:"Version 1"}),r.jsx(sE.$,{yAxisId:"amount",dataKey:"v2_total",fill:"#6366f1",name:"Version 2"}),r.jsx(sL.x,{yAxisId:"percent",type:"monotone",dataKey:"changePercent",stroke:"#f97316",strokeWidth:2,name:"Change %",dot:{fill:"#f97316",r:4}})]})})})]})}function sV({data:e}){let t=(0,a.useMemo)(()=>{let t=[...e].sort((e,t)=>Math.abs(t.change)-Math.abs(e.change));return{topIncreases:t.filter(e=>e.change>0).slice(0,3),topDecreases:t.filter(e=>e.change<0).slice(0,3),largestPercent:t.sort((e,t)=>Math.abs(t.changePercent)-Math.abs(e.changePercent))[0]}},[e]),s=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(Math.abs(e));return(0,r.jsxs)("div",{className:"grid gap-4",children:[t.topIncreases.length>0&&(0,r.jsxs)(ey.Zb,{className:"border-green-200 bg-green-50/30",children:[r.jsx(ey.Ol,{className:"pb-3",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx(tc.Z,{className:"w-5 h-5 text-green-600"}),r.jsx(ey.ll,{className:"text-base",children:"Top Budget Increases"})]})}),r.jsx(ey.aY,{children:r.jsx("div",{className:"space-y-2",children:t.topIncreases.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("p",{className:"text-sm font-medium",children:e.category}),r.jsx("p",{className:"text-xs text-muted-foreground",children:e.item})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("p",{className:"text-sm font-semibold text-green-600",children:["+",s(e.change)]}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["+",e.changePercent.toFixed(1),"%"]})]})]},t))})})]}),t.topDecreases.length>0&&(0,r.jsxs)(ey.Zb,{className:"border-red-200 bg-red-50/30",children:[r.jsx(ey.Ol,{className:"pb-3",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx(tu.Z,{className:"w-5 h-5 text-red-600"}),r.jsx(ey.ll,{className:"text-base",children:"Top Budget Decreases"})]})}),r.jsx(ey.aY,{children:r.jsx("div",{className:"space-y-2",children:t.topDecreases.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("p",{className:"text-sm font-medium",children:e.category}),r.jsx("p",{className:"text-xs text-muted-foreground",children:e.item})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("p",{className:"text-sm font-semibold text-red-600",children:["-",s(Math.abs(e.change))]}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:[e.changePercent.toFixed(1),"%"]})]})]},t))})})]}),t.largestPercent&&Math.abs(t.largestPercent.changePercent)>10&&(0,r.jsxs)(ey.Zb,{className:"border-orange-200 bg-orange-50/30",children:[r.jsx(ey.Ol,{className:"pb-3",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx(m.Z,{className:"w-5 h-5 text-orange-600"}),r.jsx(ey.ll,{className:"text-base",children:"Significant % Change"})]})}),(0,r.jsxs)(ey.aY,{children:[(0,r.jsxs)("p",{className:"text-sm",children:[r.jsx("span",{className:"font-medium",children:t.largestPercent.category})," had a"," ",(0,r.jsxs)("span",{className:`font-bold ${t.largestPercent.change>0?"text-green-600":"text-red-600"}`,children:[t.largestPercent.changePercent>0?"+":"",t.largestPercent.changePercent.toFixed(1),"%"]})," ","change (",t.largestPercent.change>0?"+":"",s(t.largestPercent.change),")"]}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:t.largestPercent.item})]})]})]})}var sO=s(32141),sZ=s(9839),sB=s(31017),[sW,sU]=(0,w.b)("Tooltip",[sZ.D7]),sq=(0,sZ.D7)(),sY="TooltipProvider",sH="tooltip.open",[sK,sG]=sW(sY),sX=e=>{let{__scopeTooltip:t,delayDuration:s=700,skipDelayDuration:n=300,disableHoverableContent:i=!1,children:l}=e,[o,d]=a.useState(!0),c=a.useRef(!1),u=a.useRef(0);return a.useEffect(()=>{let e=u.current;return()=>window.clearTimeout(e)},[]),(0,r.jsx)(sK,{scope:t,isOpenDelayed:o,delayDuration:s,onOpen:a.useCallback(()=>{window.clearTimeout(u.current),d(!1)},[]),onClose:a.useCallback(()=>{window.clearTimeout(u.current),u.current=window.setTimeout(()=>d(!0),n)},[n]),isPointerInTransitRef:c,onPointerInTransitChange:a.useCallback(e=>{c.current=e},[]),disableHoverableContent:i,children:l})};sX.displayName=sY;var sQ="Tooltip",[sJ,s0]=sW(sQ),s1=e=>{let{__scopeTooltip:t,children:s,open:n,defaultOpen:i=!1,onOpenChange:l,disableHoverableContent:o,delayDuration:d}=e,c=sG(sQ,e.__scopeTooltip),u=sq(t),[m,h]=a.useState(null),x=(0,N.M)(),p=a.useRef(0),g=o??c.disableHoverableContent,f=d??c.delayDuration,b=a.useRef(!1),[v=!1,j]=(0,_.T)({prop:n,defaultProp:i,onChange:e=>{e?(c.onOpen(),document.dispatchEvent(new CustomEvent(sH))):c.onClose(),l?.(e)}}),y=a.useMemo(()=>v?b.current?"delayed-open":"instant-open":"closed",[v]),w=a.useCallback(()=>{window.clearTimeout(p.current),p.current=0,b.current=!1,j(!0)},[j]),C=a.useCallback(()=>{window.clearTimeout(p.current),p.current=0,j(!1)},[j]),k=a.useCallback(()=>{window.clearTimeout(p.current),p.current=window.setTimeout(()=>{b.current=!0,j(!0),p.current=0},f)},[f,j]);return a.useEffect(()=>()=>{p.current&&(window.clearTimeout(p.current),p.current=0)},[]),(0,r.jsx)(sZ.fC,{...u,children:(0,r.jsx)(sJ,{scope:t,contentId:x,open:v,stateAttribute:y,trigger:m,onTriggerChange:h,onTriggerEnter:a.useCallback(()=>{c.isOpenDelayed?k():w()},[c.isOpenDelayed,k,w]),onTriggerLeave:a.useCallback(()=>{g?C():(window.clearTimeout(p.current),p.current=0)},[C,g]),onOpen:w,onClose:C,disableHoverableContent:g,children:s})})};s1.displayName=sQ;var s2="TooltipTrigger",s4=a.forwardRef((e,t)=>{let{__scopeTooltip:s,...n}=e,i=s0(s2,s),l=sG(s2,s),o=sq(s),d=a.useRef(null),c=(0,y.e)(t,d,i.onTriggerChange),u=a.useRef(!1),m=a.useRef(!1),h=a.useCallback(()=>u.current=!1,[]);return a.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),(0,r.jsx)(sZ.ee,{asChild:!0,...o,children:(0,r.jsx)(P.WV.button,{"aria-describedby":i.open?i.contentId:void 0,"data-state":i.stateAttribute,...n,ref:c,onPointerMove:(0,j.M)(e.onPointerMove,e=>{"touch"===e.pointerType||m.current||l.isPointerInTransitRef.current||(i.onTriggerEnter(),m.current=!0)}),onPointerLeave:(0,j.M)(e.onPointerLeave,()=>{i.onTriggerLeave(),m.current=!1}),onPointerDown:(0,j.M)(e.onPointerDown,()=>{u.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:(0,j.M)(e.onFocus,()=>{u.current||i.onOpen()}),onBlur:(0,j.M)(e.onBlur,i.onClose),onClick:(0,j.M)(e.onClick,i.onClose)})})});s4.displayName=s2;var s6="TooltipPortal",[s3,s5]=sW(s6,{forceMount:void 0}),s7=e=>{let{__scopeTooltip:t,forceMount:s,children:a,container:n}=e,i=s0(s6,t);return(0,r.jsx)(s3,{scope:t,forceMount:s,children:(0,r.jsx)(E.z,{present:s||i.open,children:(0,r.jsx)(S.h,{asChild:!0,container:n,children:a})})})};s7.displayName=s6;var s8="TooltipContent",s9=a.forwardRef((e,t)=>{let s=s5(s8,e.__scopeTooltip),{forceMount:a=s.forceMount,side:n="top",...i}=e,l=s0(s8,e.__scopeTooltip);return(0,r.jsx)(E.z,{present:a||l.open,children:l.disableHoverableContent?(0,r.jsx)(rr,{side:n,...i,ref:t}):(0,r.jsx)(re,{side:n,...i,ref:t})})}),re=a.forwardRef((e,t)=>{let s=s0(s8,e.__scopeTooltip),n=sG(s8,e.__scopeTooltip),i=a.useRef(null),l=(0,y.e)(t,i),[o,d]=a.useState(null),{trigger:c,onClose:u}=s,m=i.current,{onPointerInTransitChange:h}=n,x=a.useCallback(()=>{d(null),h(!1)},[h]),p=a.useCallback((e,t)=>{let s=e.currentTarget,r={x:e.clientX,y:e.clientY},a=function(e,t){let s=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),n=Math.abs(t.left-e.x);switch(Math.min(s,r,a,n)){case n:return"left";case a:return"right";case s:return"top";case r:return"bottom";default:throw Error("unreachable")}}(r,s.getBoundingClientRect());d(function(e){let t=e.slice();return t.sort((e,t)=>e.x<t.x?-1:e.x>t.x?1:e.y<t.y?-1:e.y>t.y?1:0),function(e){if(e.length<=1)return e.slice();let t=[];for(let s=0;s<e.length;s++){let r=e[s];for(;t.length>=2;){let e=t[t.length-1],s=t[t.length-2];if((e.x-s.x)*(r.y-s.y)>=(e.y-s.y)*(r.x-s.x))t.pop();else break}t.push(r)}t.pop();let s=[];for(let t=e.length-1;t>=0;t--){let r=e[t];for(;s.length>=2;){let e=s[s.length-1],t=s[s.length-2];if((e.x-t.x)*(r.y-t.y)>=(e.y-t.y)*(r.x-t.x))s.pop();else break}s.push(r)}return(s.pop(),1===t.length&&1===s.length&&t[0].x===s[0].x&&t[0].y===s[0].y)?t:t.concat(s)}(t)}([...function(e,t,s=5){let r=[];switch(t){case"top":r.push({x:e.x-s,y:e.y+s},{x:e.x+s,y:e.y+s});break;case"bottom":r.push({x:e.x-s,y:e.y-s},{x:e.x+s,y:e.y-s});break;case"left":r.push({x:e.x+s,y:e.y-s},{x:e.x+s,y:e.y+s});break;case"right":r.push({x:e.x-s,y:e.y-s},{x:e.x-s,y:e.y+s})}return r}(r,a),...function(e){let{top:t,right:s,bottom:r,left:a}=e;return[{x:a,y:t},{x:s,y:t},{x:s,y:r},{x:a,y:r}]}(t.getBoundingClientRect())])),h(!0)},[h]);return a.useEffect(()=>()=>x(),[x]),a.useEffect(()=>{if(c&&m){let e=e=>p(e,m),t=e=>p(e,c);return c.addEventListener("pointerleave",e),m.addEventListener("pointerleave",t),()=>{c.removeEventListener("pointerleave",e),m.removeEventListener("pointerleave",t)}}},[c,m,p,x]),a.useEffect(()=>{if(o){let e=e=>{let t=e.target,s={x:e.clientX,y:e.clientY},r=c?.contains(t)||m?.contains(t),a=!function(e,t){let{x:s,y:r}=e,a=!1;for(let e=0,n=t.length-1;e<t.length;n=e++){let i=t[e].x,l=t[e].y,o=t[n].x,d=t[n].y;l>r!=d>r&&s<(o-i)*(r-l)/(d-l)+i&&(a=!a)}return a}(s,o);r?x():a&&(x(),u())};return document.addEventListener("pointermove",e),()=>document.removeEventListener("pointermove",e)}},[c,m,o,u,x]),(0,r.jsx)(rr,{...e,ref:l})}),[rt,rs]=sW(sQ,{isInside:!1}),rr=a.forwardRef((e,t)=>{let{__scopeTooltip:s,children:n,"aria-label":i,onEscapeKeyDown:l,onPointerDownOutside:o,...d}=e,c=s0(s8,s),u=sq(s),{onClose:m}=c;return a.useEffect(()=>(document.addEventListener(sH,m),()=>document.removeEventListener(sH,m)),[m]),a.useEffect(()=>{if(c.trigger){let e=e=>{let t=e.target;t?.contains(c.trigger)&&m()};return window.addEventListener("scroll",e,{capture:!0}),()=>window.removeEventListener("scroll",e,{capture:!0})}},[c.trigger,m]),(0,r.jsx)(C.XB,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:l,onPointerDownOutside:o,onFocusOutside:e=>e.preventDefault(),onDismiss:m,children:(0,r.jsxs)(sZ.VY,{"data-state":c.stateAttribute,...u,...d,ref:t,style:{...d.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[(0,r.jsx)(z.A4,{children:n}),(0,r.jsx)(rt,{scope:s,isInside:!0,children:(0,r.jsx)(sB.f,{id:c.contentId,role:"tooltip",children:i||n})})]})})});s9.displayName=s8;var ra="TooltipArrow",rn=a.forwardRef((e,t)=>{let{__scopeTooltip:s,...a}=e,n=sq(s);return rs(ra,s).isInside?null:(0,r.jsx)(sZ.Eh,{...n,...a,ref:t})});function ri({delayDuration:e=0,...t}){return r.jsx(sX,{"data-slot":"tooltip-provider",delayDuration:e,...t})}function rl({...e}){return r.jsx(ri,{children:r.jsx(s1,{"data-slot":"tooltip",...e})})}function ro({...e}){return r.jsx(s4,{"data-slot":"tooltip-trigger",...e})}function rd({className:e,sideOffset:t=0,children:s,...a}){return r.jsx(s7,{children:(0,r.jsxs)(s9,{"data-slot":"tooltip-content",sideOffset:t,className:(0,h.cn)("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",e),...a,children:[s,r.jsx(rn,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}rn.displayName=ra;let rc={safePercentage:(e,t)=>null==e||null==t?0:0===t?0===e?0:e>0?100:-100:Number(((e-t)/Math.abs(t)*100).toFixed(2)),formatCurrency:e=>null==e?"$0":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),formatCompactCurrency:e=>{if(null==e)return"$0";let t=Math.abs(e),s=e<0?"-":"";return t>=1e6?`${s}$${(t/1e6).toFixed(1)}M`:t>=1e3?`${s}$${(t/1e3).toFixed(0)}K`:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)},formatPercentage:e=>null==e||Number.isNaN(e)?"0%":`${e>0?"+":""}${e.toFixed(1)}%`,getChangeStatus:(e,t)=>{let s=e??0,r=t??0;return 0===s&&r>0?"added":s>0&&0===r?"removed":s===r?"unchanged":r>s?"increased":"decreased"}};function ru({version:e,comparisonVersion:t,highlights:s=[],onScroll:n,scrollTop:l=0,height:o}){let d=(0,a.useRef)(null),[c,u]=(0,a.useState)(!1);return(0,r.jsxs)("div",{className:"h-full flex flex-col",children:[(0,r.jsxs)("div",{className:"p-3 border-b bg-muted/30 sticky top-0 z-10",children:[(0,r.jsxs)("h3",{className:"font-semibold",children:["Version ",e.version]}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Total: ",rc.formatCompactCurrency(e.totalCost)]})]}),r.jsx("div",{ref:d,className:"flex-1 overflow-auto",onScroll:()=>{d.current&&(u(!0),n?.(d.current.scrollTop),setTimeout(()=>u(!1),150))},style:{height:o-80},children:e.costLines.map((e,a)=>{let n=t?.costLines.find(t=>t.costLineName===e.costLineName),l=n?rc.safePercentage(e.totalCost,n.totalCost):null,o=n?rc.getChangeStatus(n.totalCost,e.totalCost):"unchanged",d=s.includes(e.costLineName);return(0,r.jsxs)("div",{className:(0,h.cn)("px-4 py-3 border-b flex items-center justify-between transition-colors hover:bg-muted/50",d&&"bg-yellow-50","increased"===o&&"bg-red-50","decreased"===o&&"bg-green-50"),children:[(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("div",{className:"font-medium",children:e.costLineName}),r.jsx(ri,{children:(0,r.jsxs)(rl,{children:[r.jsx(ro,{asChild:!0,children:r.jsx("div",{className:"text-lg cursor-help",children:rc.formatCompactCurrency(e.totalCost)})}),r.jsx(rd,{children:r.jsx("p",{children:rc.formatCurrency(e.totalCost)})})]})})]}),null!==l&&0!==l&&r.jsx(i.C,{variant:"increased"===o?"destructive":"decreased"===o?"outline":"secondary",className:(0,h.cn)("ml-2",l>0&&"text-red-600 dark:text-red-400",l<0&&"text-green-600 dark:text-green-400",0===l&&"text-gray-600 dark:text-gray-400"),children:rc.formatPercentage(l)}),!n&&e.totalCost>0&&r.jsx(i.C,{variant:"secondary",className:"ml-2 text-green-600 dark:text-green-400",children:"New +100%"})]},a)})})]})}var rm=s(86844);let rh=(0,l.Z)("Columns2",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M12 3v18",key:"108xh3"}]]),rx=(0,l.Z)("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);var rp=s(32987),rg=s(6900);function rf(e){return null==e?"$0":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}function rb(e){return`${e>0?"+":""}${e.toFixed(1)}%`}function rv({title:e,value:t,change:s,trend:a="neutral",icon:n,className:i,description:l}){let o={up:r.jsx(tc.Z,{className:"h-4 w-4"}),down:r.jsx(tu.Z,{className:"h-4 w-4"}),neutral:r.jsx(rm.Z,{className:"h-4 w-4"})};return r.jsx(ey.Zb,{className:(0,h.cn)("hover:shadow-md transition-shadow",i),children:(0,r.jsxs)(ey.aY,{className:"p-4",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between space-x-2",children:[(0,r.jsxs)("div",{className:"space-y-1 flex-1",children:[r.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:e}),r.jsx("p",{className:"text-2xl font-bold tracking-tight",children:t}),l&&r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:l})]}),n&&r.jsx("div",{className:"text-muted-foreground",children:n})]}),void 0!==s&&(0,r.jsxs)("div",{className:(0,h.cn)("flex items-center gap-1 mt-2",{up:"text-red-600 dark:text-red-400",down:"text-green-600 dark:text-green-400",neutral:"text-muted-foreground"}[a]),children:[o[a],r.jsx("span",{className:"text-xs font-medium",children:s})]})]})})}function rj({isOpen:e,onClose:t,projectData:s,versions:n,mode:l="sheet",showAdvancedFeatures:o=!1}){let d=function(){let[e,t]=a.useState(void 0);return a.useEffect(()=>{let e=window.matchMedia("(max-width: 767px)"),s=()=>{t(window.innerWidth<768)};return e.addEventListener("change",s),t(window.innerWidth<768),()=>e.removeEventListener("change",s)},[]),!!e}(),[c,u]=(0,a.useState)("all"),[m,x]=(0,a.useState)(""),[p,g]=(0,a.useState)("all"),[f,v]=(0,a.useState)("overview"),[j,y]=(0,a.useState)("side-by-side"),[w,N]=(0,a.useState)(1),[_,C]=(0,a.useState)(2),k=n.find(e=>e.version===w)||n[0],S=n.find(e=>e.version===_)||n[1],E=(0,a.useMemo)(()=>{if(!k||!S)return null;let e=new Map(k.costLines.map(e=>[e.costLineName,e])),t=new Map(S.costLines.map(e=>[e.costLineName,e])),s=new Set([...e.keys(),...t.keys()]),r=[];s.forEach(s=>{let a=e.get(s),n=t.get(s),i=a?.totalCost||0,l=n?.totalCost||0,o=l-i,d=0!==i?o/Math.abs(i)*100:0!==l?100:0,c="unchanged";!a&&n?c="added":a&&!n?c="removed":o>0?c="increased":o<0&&(c="decreased"),r.push({id:n?.id||a?.id||s,costLineName:s,category:n?.category||a?.category||"Uncategorized",v1_amount:i,v2_amount:l,change:o,changePercent:d,status:c})});let a=S.totalCost-k.totalCost,n=0!==k.totalCost?a/Math.abs(k.totalCost)*100:0,i=r.filter(e=>"added"===e.status).length,l=r.filter(e=>"removed"===e.status).length,o=r.filter(e=>"increased"===e.status).length,d=r.filter(e=>"decreased"===e.status).length;return{differences:r,summary:{v1Total:k.totalCost,v2Total:S.totalCost,totalChange:a,changePercent:n,addedCount:i,removedCount:l,increasedCount:o,decreasedCount:d,totalLines:r.length}}},[k,S]),P=(0,a.useMemo)(()=>{if(!E)return[];let e=[...E.differences];if("all"!==c&&(e="changed"===c?e.filter(e=>"unchanged"!==e.status):e.filter(e=>e.status===c)),"all"!==p&&(e=e.filter(e=>e.category===p)),m){let t=m.toLowerCase();e=e.filter(e=>e.costLineName.toLowerCase().includes(t)||e.category.toLowerCase().includes(t))}return e.sort((e,t)=>Math.abs(t.change)-Math.abs(e.change))},[E,c,p,m]),D=(0,a.useMemo)(()=>E?Array.from(new Set(E.differences.map(e=>e.category))).sort():[],[E]),T=(0,a.useCallback)(()=>{if(!E)return;let e=new Blob([[["Cost Line","Category",`Version ${k.version}`,`Version ${S.version}`,"Change","Change %","Status"],...P.map(e=>[e.costLineName,e.category,e.v1_amount,e.v2_amount,e.change,`${e.changePercent.toFixed(2)}%`,e.status])].map(e=>e.join(",")).join("\n")],{type:"text/csv"}),t=URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download=`version-comparison-${s.name}-v${k.version}-v${S.version}.csv`,r.click(),URL.revokeObjectURL(t)},[E,P,s,k,S]);if(!E)return null;let M=(0,r.jsxs)("div",{className:"flex flex-col h-full",children:[(0,r.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)(tr.Ph,{value:w.toString(),onValueChange:e=>N(Number(e)),children:[r.jsx(tr.i4,{className:"w-[150px]",children:r.jsx(tr.ki,{placeholder:"Select version"})}),r.jsx(tr.Bw,{children:n.map(e=>(0,r.jsxs)(tr.Ql,{value:e.version.toString(),children:["Version ",e.version]},e.version))})]}),r.jsx(tp,{className:"h-5 w-5 self-center text-muted-foreground"}),(0,r.jsxs)(tr.Ph,{value:_.toString(),onValueChange:e=>C(Number(e)),children:[r.jsx(tr.i4,{className:"w-[150px]",children:r.jsx(tr.ki,{placeholder:"Select version"})}),r.jsx(tr.Bw,{children:n.map(e=>(0,r.jsxs)(tr.Ql,{value:e.version.toString(),children:["Version ",e.version]},e.version))})]}),(0,r.jsxs)("div",{className:"ml-auto flex gap-2",children:[!d&&(0,r.jsxs)(sa,{type:"single",value:j,onValueChange:e=>e&&y(e),children:[r.jsx(sn,{value:"side-by-side","aria-label":"Side by side view",children:r.jsx(rh,{className:"h-4 w-4"})}),r.jsx(sn,{value:"unified","aria-label":"Unified view",children:r.jsx(rx,{className:"h-4 w-4"})})]}),(0,r.jsxs)(b.z,{variant:"outline",size:"sm",onClick:T,children:[r.jsx(tw,{className:"h-4 w-4 mr-1"}),"Export"]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[r.jsx(rv,{title:"Total Change",value:rf(E.summary.totalChange),change:rb(E.summary.changePercent),trend:E.summary.totalChange>0?"up":E.summary.totalChange<0?"down":"neutral",icon:r.jsx(rp.Z,{className:"h-5 w-5"})}),r.jsx(rv,{title:"Items Changed",value:E.summary.totalLines-E.differences.filter(e=>"unchanged"===e.status).length,description:`of ${E.summary.totalLines} total`,icon:r.jsx(rg.Z,{className:"h-5 w-5"})}),r.jsx(rv,{title:"Items Added",value:E.summary.addedCount,trend:"neutral",icon:r.jsx(to,{className:"h-5 w-5"})}),r.jsx(rv,{title:"Items Removed",value:E.summary.removedCount,trend:"neutral",icon:r.jsx(rm.Z,{className:"h-5 w-5"})})]})]}),(0,r.jsxs)(sy,{value:f,onValueChange:v,className:"flex-1 flex flex-col",children:[(0,r.jsxs)(sw,{className:"grid grid-cols-3 w-full max-w-[400px]",children:[r.jsx(sN,{value:"overview",children:"Overview"}),r.jsx(sN,{value:"details",children:"Details"}),r.jsx(sN,{value:"charts",children:"Charts"})]}),r.jsx(s_,{value:"overview",className:"flex-1 mt-4",children:(0,r.jsxs)("div",{className:"space-y-6",children:[o&&(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,r.jsxs)(tr.Ph,{value:c,onValueChange:e=>u(e),children:[r.jsx(tr.i4,{className:"w-[150px]",children:r.jsx(tr.ki,{})}),(0,r.jsxs)(tr.Bw,{children:[r.jsx(tr.Ql,{value:"all",children:"All Items"}),r.jsx(tr.Ql,{value:"changed",children:"Changed Only"}),r.jsx(tr.Ql,{value:"added",children:"Added"}),r.jsx(tr.Ql,{value:"removed",children:"Removed"}),r.jsx(tr.Ql,{value:"increased",children:"Increased"}),r.jsx(tr.Ql,{value:"decreased",children:"Decreased"})]})]}),(0,r.jsxs)(tr.Ph,{value:p,onValueChange:g,children:[r.jsx(tr.i4,{className:"w-[150px]",children:r.jsx(tr.ki,{})}),(0,r.jsxs)(tr.Bw,{children:[r.jsx(tr.Ql,{value:"all",children:"All Categories"}),D.map(e=>r.jsx(tr.Ql,{value:e,children:e},e))]})]}),r.jsx(tt,{placeholder:"Search cost lines...",value:m,onChange:e=>x(e.target.value),className:"w-[200px]"})]}),"side-by-side"!==j||d?r.jsx(e8,{className:"h-[600px]",children:(0,r.jsxs)(te.iA,{children:[r.jsx(te.xD,{children:(0,r.jsxs)(te.SC,{children:[r.jsx(te.ss,{children:"Cost Line"}),r.jsx(te.ss,{children:"Category"}),(0,r.jsxs)(te.ss,{className:"text-right",children:["V",k.version]}),(0,r.jsxs)(te.ss,{className:"text-right",children:["V",S.version]}),r.jsx(te.ss,{className:"text-right",children:"Change"}),r.jsx(te.ss,{className:"text-center",children:"Status"})]})}),r.jsx(te.RM,{children:P.map(e=>(0,r.jsxs)(te.SC,{children:[r.jsx(te.pj,{className:"font-medium",children:e.costLineName}),r.jsx(te.pj,{children:r.jsx(i.C,{variant:"outline",children:e.category})}),r.jsx(te.pj,{className:"text-right",children:rf(e.v1_amount)}),r.jsx(te.pj,{className:"text-right",children:rf(e.v2_amount)}),r.jsx(te.pj,{className:"text-right",children:(0,r.jsxs)("span",{className:(0,h.cn)("font-medium",e.change>0&&"text-red-600",e.change<0&&"text-green-600"),children:[rf(e.change),(0,r.jsxs)("span",{className:"text-xs ml-1",children:["(",rb(e.changePercent),")"]})]})}),r.jsx(te.pj,{className:"text-center",children:r.jsx(i.C,{variant:"added"===e.status?"default":"removed"===e.status?"secondary":"increased"===e.status?"destructive":(e.status,"outline"),children:e.status})})]},e.id))})]})}):(0,r.jsxs)(sO.pO,{direction:"horizontal",className:"min-h-[600px]",children:[r.jsx(sO.ee,{defaultSize:50,children:r.jsx(ru,{version:k,comparisonVersion:S,height:600})}),r.jsx(sO.Dp,{withHandle:!0}),r.jsx(sO.ee,{defaultSize:50,children:r.jsx(ru,{version:S,comparisonVersion:k,height:600})})]})]})}),r.jsx(s_,{value:"details",className:"flex-1 mt-4",children:r.jsx("div",{className:"space-y-4",children:r.jsx(sV,{data:P.map(e=>({category:e.category,item:e.costLineName,change:e.change,changePercent:e.changePercent}))})})}),r.jsx(s_,{value:"charts",className:"flex-1 mt-4",children:(0,r.jsxs)("div",{className:"space-y-6",children:[r.jsx(s$,{data:E.differences.map(e=>({...e,category:e.category||"Uncategorized"})),title:"Budget Change Waterfall",description:"Visual breakdown of changes between versions"}),r.jsx(sA,{data:(()=>{let e=new Map;return E.differences.forEach(t=>{let s=t.category||"Uncategorized",r=e.get(s)||{v1:0,v2:0};r.v1+=t.v1_amount||0,r.v2+=t.v2_amount||0,e.set(s,r)}),Array.from(e.entries()).map(([e,t])=>({category:e,v1_total:t.v1,v2_total:t.v2,change:t.v2-t.v1,changePercent:0!==t.v1?(t.v2-t.v1)/Math.abs(t.v1)*100:0}))})()})]})})]})]});return"dialog"===l?r.jsx(em,{open:e,onOpenChange:t,children:(0,r.jsxs)(eg,{className:"max-w-[90vw] max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)(ef,{children:[(0,r.jsxs)(ev,{children:["Version Comparison - ",s.name]}),r.jsx(ej,{children:"Compare budget versions to understand changes and trends"})]}),M]})}):r.jsx(tk,{open:e,onOpenChange:t,children:(0,r.jsxs)(tP,{side:"right",className:"w-full sm:w-[90%] sm:max-w-[1400px] overflow-y-auto","aria-describedby":"version-comparison-description",children:[(0,r.jsxs)(tD,{children:[(0,r.jsxs)(tT,{children:["Version Comparison - ",s.name]}),r.jsx(tM,{id:"version-comparison-description",children:"Compare budget versions to understand changes and trends"})]}),r.jsx(sC.Z,{className:"my-4"}),M]})})}var ry=s(45034);let rw="cost-management-backup",rN="1.0.0";class r_{static saveBackup(e){try{let t={stagedEntries:e,timestamp:Date.now(),version:rN};localStorage.setItem(rw,JSON.stringify(t))}catch(e){console.error("Failed to save backup:",e)}}static loadBackup(){try{let e=localStorage.getItem(rw);if(!e)return null;let t=JSON.parse(e);if((Date.now()-t.timestamp)/36e5>24)return this.clearBackup(),null;if(t.version!==rN)return console.warn("Backup version mismatch, discarding"),this.clearBackup(),null;return t}catch(e){return console.error("Failed to load backup:",e),null}}static clearBackup(){try{localStorage.removeItem(rw)}catch(e){console.error("Failed to clear backup:",e)}}static hasBackup(){return null!==localStorage.getItem(rw)}}function rC({value:e,onSave:t,type:s="text",className:n,placeholder:i="Click to edit",disabled:l=!1,formatter:o,validator:d}){let[c,u]=(0,a.useState)(!1),[m,x]=(0,a.useState)(e),[p,g]=(0,a.useState)(null),f=(0,a.useRef)(null),b=()=>{if(d){let e=d(m);if(!0!==e){g("string"==typeof e?e:"Invalid value");return}}m!==e&&t("number"===s?Number(m):m),u(!1),g(null)},v=()=>{x(e),u(!1),g(null)},j=o?o(e):e;return l?r.jsx("span",{className:(0,h.cn)("inline-block",n),children:j||r.jsx("span",{className:"text-gray-400",children:i})}):c?(0,r.jsxs)("div",{className:"relative inline-block",children:[r.jsx(tt,{ref:f,type:s,value:m,onChange:e=>{x(e.target.value),g(null)},onBlur:b,onKeyDown:e=>{"Enter"===e.key?b():"Escape"===e.key&&v()},className:(0,h.cn)("h-auto py-1 px-2",p&&"border-red-500 focus:ring-red-500",n)}),p&&r.jsx("div",{className:"absolute top-full left-0 mt-1 text-xs text-red-600 whitespace-nowrap z-10",children:p})]}):r.jsx("button",{onClick:()=>u(!0),className:(0,h.cn)("inline-block cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800 rounded px-2 py-1 -mx-2 -my-1 transition-colors","focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",n),children:j||r.jsx("span",{className:"text-gray-400",children:i})})}let rk=(0,l.Z)("Keyboard",[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]]),rS=[{category:"General",items:[{keys:["âŒ˜/Ctrl","S"],description:"Save changes"},{keys:["âŒ˜/Ctrl","N"],description:"New entry"},{keys:["Esc"],description:"Cancel/Close"}]},{category:"Selection",items:[{keys:["âŒ˜/Ctrl","A"],description:"Select all items"},{keys:["Delete"],description:"Delete selected items"},{keys:["Space"],description:"Toggle item selection"}]},{category:"Navigation",items:[{keys:["Tab"],description:"Next field"},{keys:["Shift","Tab"],description:"Previous field"},{keys:["Enter"],description:"Save and next"}]},{category:"Editing",items:[{keys:["Click"],description:"Start inline edit"},{keys:["Enter"],description:"Save edit"},{keys:["Esc"],description:"Cancel edit"}]}];function rE(){return(0,r.jsxs)(em,{children:[r.jsx(eh,{asChild:!0,children:(0,r.jsxs)("button",{className:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground h-8 px-3",children:[r.jsx(rk,{className:"w-4 h-4"}),r.jsx("span",{className:"hidden lg:inline",children:"Shortcuts"})]})}),(0,r.jsxs)(eg,{className:"sm:max-w-[600px]",children:[(0,r.jsxs)(ef,{children:[r.jsx(ev,{children:"Keyboard Shortcuts"}),r.jsx(ej,{children:"Use these keyboard shortcuts to work faster"})]}),r.jsx("div",{className:"space-y-6",children:rS.map(e=>(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"font-semibold text-sm text-gray-900 dark:text-gray-100 mb-2",children:e.category}),r.jsx("div",{className:"space-y-2",children:e.items.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[r.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:e.description}),r.jsx("div",{className:"flex items-center gap-1",children:e.keys.map((t,s)=>(0,r.jsxs)("span",{children:[r.jsx("kbd",{className:"px-2 py-1 text-xs font-semibold text-gray-800 bg-gray-100 border border-gray-200 rounded-lg dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600",children:t}),s<e.keys.length-1&&r.jsx("span",{className:"mx-1 text-gray-400",children:"+"})]},s))})]},e.description))})]},e.category))})]})]})}var rP=s(78780);function rD({budget:e,actual:t,loading:s=!1,className:a,onViewDetails:n}){let l=e-t.total,o=e>0?l/e*100:0,d=e>0?t.total/e*100:0,c=t.total>0?t.invoiced/t.total*100:0,u=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(Math.abs(e)),x=e=>{let t=Math.abs(e);return t>=1e6?`$${(t/1e6).toFixed(1)}M`:t>=1e3?`$${(t/1e3).toFixed(0)}K`:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t)};return s?(0,r.jsxs)(ey.Zb,{className:a,children:[r.jsx(ey.Ol,{children:(0,r.jsxs)(ey.ll,{className:"text-lg flex items-center gap-2",children:[r.jsx(rp.Z,{className:"w-5 h-5"}),"Budget vs Actual"]})}),r.jsx(ey.aY,{children:r.jsx("div",{className:"flex items-center justify-center py-8",children:r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})})]}):0===t.mappingCount?(0,r.jsxs)(ey.Zb,{className:(0,h.cn)("border-dashed",a),children:[r.jsx(ey.Ol,{children:(0,r.jsxs)(ey.ll,{className:"text-lg flex items-center gap-2",children:[r.jsx(rp.Z,{className:"w-5 h-5"}),"Budget vs Actual"]})}),r.jsx(ey.aY,{children:(0,r.jsxs)("div",{className:"text-center py-6",children:[r.jsx(rP.Z,{className:"w-12 h-12 mx-auto text-gray-400 mb-3"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"No PO mappings found"}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Map POs to see actual spending"})]})})]}):(0,r.jsxs)(ey.Zb,{className:a,children:[r.jsx(ey.Ol,{children:(0,r.jsxs)(ey.ll,{className:"text-lg flex items-center gap-2",children:[r.jsx(rp.Z,{className:"w-5 h-5"}),"Budget vs Actual"]})}),(0,r.jsxs)(ey.aY,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Budget"}),r.jsx(ri,{children:(0,r.jsxs)(rl,{children:[r.jsx(ro,{asChild:!0,children:r.jsx("p",{className:"text-xl font-bold cursor-help",children:x(e)})}),r.jsx(rd,{children:r.jsx("p",{children:u(e)})})]})})]}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Actual (POs)"}),r.jsx(ri,{children:(0,r.jsxs)(rl,{children:[r.jsx(ro,{asChild:!0,children:r.jsx("p",{className:"text-xl font-bold cursor-help",children:x(t.total)})}),r.jsx(rd,{children:r.jsx("p",{children:u(t.total)})})]})})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{className:"text-muted-foreground",children:"Budget Utilization"}),(0,r.jsxs)("span",{className:"font-medium",children:[d.toFixed(1),"%"]})]}),r.jsx(eN.E,{value:Math.min(d,100),className:(0,h.cn)("h-2",d>100&&"[&>div]:bg-red-500",d>90&&d<=100&&"[&>div]:bg-yellow-500")}),d>100&&(0,r.jsxs)("div",{className:"flex items-center gap-1 text-xs text-red-600",children:[r.jsx(m.Z,{className:"w-3 h-3"}),"Over budget by ",u(Math.abs(l))]})]}),(0,r.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsxs)("span",{className:"text-muted-foreground flex items-center gap-1",children:[r.jsx(ti.Z,{className:"w-3 h-3"}),"Invoiced"]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-medium",children:u(t.invoiced)}),(0,r.jsxs)(i.C,{variant:"outline",className:"text-xs",children:[c.toFixed(0),"%"]})]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsxs)("span",{className:"text-muted-foreground flex items-center gap-1",children:[r.jsx(rP.Z,{className:"w-3 h-3"}),"Open"]}),r.jsx("span",{className:"font-medium",children:u(t.open)})]})]}),r.jsx(sC.Z,{}),(0,r.jsxs)("div",{className:(0,h.cn)("flex justify-between items-center",l>=0?"text-green-600":10>=Math.abs(o)?"text-yellow-600":"text-red-600"),children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[l>=0?r.jsx(tu.Z,{className:"w-4 h-4"}):r.jsx(tc.Z,{className:"w-4 h-4"}),r.jsx("span",{className:"font-medium",children:"Variance"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("span",{className:"font-bold",children:[l>=0?"-":"+",u(l)]}),(0,r.jsxs)(i.C,{variant:l>=0?"default":"destructive",className:"text-xs",children:[o>0?"-":"+",Math.abs(o).toFixed(1),"%"]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"text-xs text-muted-foreground text-center",children:["Based on ",t.mappingCount," mapped PO",1!==t.mappingCount?"s":""]}),n&&r.jsx(b.z,{variant:"outline",size:"sm",className:"w-full",onClick:n,children:"View PO Details"})]})]})]})}var rT=s(53320);let rM=["WIS","Drilling","Production","Facilities","Subsea","FPSO"],rz=["M&S","Services","Equipment","Labor","Contractors","Consumables"],rR=["Operational","Maintenance","Capital","Emergency","Planned"];function rF(){let{toast:e}=(0,ry.pm)(),t=(0,rT.useRouter)(),[s,i]=(0,a.useState)(""),[l,o]=(0,a.useState)([]),[d,c]=(0,a.useState)(new Set),[u,m]=(0,a.useState)({}),[h,x]=(0,a.useState)(null),[g,f]=(0,a.useState)(null),[j,y]=(0,a.useState)(!0),[w,N]=(0,a.useState)(new Set),[_,C]=(0,a.useState)(null),[k,S]=(0,a.useState)(null),[E,P]=(0,a.useState)(!1),[D,T]=(0,a.useState)(null),[M,z]=(0,a.useState)(null),[R,F]=(0,a.useState)({}),[I,L]=(0,a.useState)(""),[$,A]=(0,a.useState)({}),[V,O]=(0,a.useState)({}),[Z,B]=(0,a.useState)(!1),[W,U]=(0,a.useState)({}),[q,Y]=(0,a.useState)({}),H=(0,a.useRef)(new Set),[K,G]=(0,a.useState)(null),X=(0,n.e)(),[Q,J]=(0,a.useState)({}),[ee,et]=(0,a.useState)({}),[es,er]=(0,a.useState)(!1),[ea,en]=(0,a.useState)({name:"",sub_business_line:""}),[ei,el]=(0,a.useState)(!1),[eo,ed]=(0,a.useState)(new Set),[ec,eu]=(0,a.useState)({}),[em,eh]=(0,a.useState)(null),[ex,ep]=(0,a.useState)({}),[eg,ef]=(0,a.useState)(null),[eb,ev]=(0,a.useState)(new Set),[ej,ey]=(0,a.useState)(!1),[ew,eN]=(0,a.useState)(null),[e_,eC]=(0,a.useState)(null),[ek,eS]=(0,a.useState)({}),[eE,eP]=(0,a.useState)(!1),eD=e=>{let t=e.id?.startsWith("temp_"),s=e._modified,r="hover:bg-gray-50";return t?r+=" bg-amber-50/50 border-l-4 border-l-amber-500":s&&(r+=" bg-blue-50/50 border-l-4 border-l-blue-500"),r},eT=async(e,t=3,s=1e3)=>{for(let r=0;r<t;r++)try{return await e()}catch(e){if(r===t-1)throw e;console.log(`Retry attempt ${r+1} of ${t} after ${s}ms`),await new Promise(e=>setTimeout(e,s))}throw Error("Max retries exceeded")},eM=e=>{let t=[];if("id"in e&&"string"==typeof e.id&&e.id.startsWith("temp_")&&t.push("id (temporary)"),"_tempId"in e&&t.push("_tempId"),Object.keys(e).forEach(e=>{e.startsWith("_")&&t.push(e)}),t.length>0)throw console.error("Invalid fields detected in database entry:",t),console.error("Entry:",e),Error(`Cannot save entry with temporary fields: ${t.join(", ")}`);let s=["project_id","sub_business_line","cost_line","spend_type","spend_sub_category"].filter(t=>!e[t]||""===e[t]);if(s.length>0)throw Error(`Missing required fields: ${s.join(", ")}`)},ez=(e,t)=>{let{id:s,_tempId:r,...a}=e,n={project_id:a.project_id||t,sub_business_line:a.sub_business_line||"",cost_line:a.cost_line||"",spend_type:a.spend_type||"",spend_sub_category:a.spend_sub_category||"",budget_cost:"number"==typeof a.budget_cost?a.budget_cost:parseFloat(a.budget_cost)||0};return eM(n),n},eR=async()=>{try{let{data:e,error:t}=await X.from("projects").select("*").order("created_at",{ascending:!1});if(t)throw t;o(e||[])}catch(t){console.error("Error loading projects:",t),e({variant:"destructive",title:"Failed to Load Projects",description:"Unable to load projects. Please refresh the page."})}finally{y(!1)}},eF=async t=>{try{let e=V[t];if(e&&e.length>0)console.log("Found forecast versions, loading latest instead of base cost breakdown"),await eI(t,"latest");else{let{data:e,error:s}=await X.from("cost_breakdown").select("*").eq("project_id",t).order("spend_sub_category");if(s)throw s;m(s=>({...s,[t]:e||[]}))}}catch(t){console.error("Error loading cost breakdown:",t),e({variant:"destructive",title:"Failed to Load Cost Breakdown",description:"Unable to load cost details. Please try again."})}},eI=async(e,t)=>{let s=`${e}-${t}`;if(H.current.has(s)){console.log(`Already loading ${s}, skipping duplicate request`);return}H.current.add(s),Y(t=>({...t,[e]:!0}));try{if("latest"===t){let t=V[e]||[];if(t.length>0){let s=Math.max(...t.map(e=>e.version_number)),{data:r,error:a}=await X.from("forecast_versions").select("*").eq("project_id",e).eq("version_number",s).single();if(a)throw a;let{data:n,error:i}=await X.from("budget_forecasts").select(`
              *,
              cost_breakdown (*)
            `).eq("forecast_version_id",r.id).order("id");if(i)throw console.error("Error loading forecast data:",i),i;if(n&&0!==n.length){let t=n.map(e=>(console.log("Forecast item:",{breakdown_id:e.cost_breakdown?.id,original_budget:e.cost_breakdown?.budget_cost,forecasted_cost:e.forecasted_cost}),{...e.cost_breakdown,budget_cost:e.forecasted_cost,forecast_id:e.id,_original_budget:e.cost_breakdown?.budget_cost}));console.log(`Loaded latest version (${s}) for project ${e}:`,t.length,"items"),console.log("Transformed data sample:",t[0]),m(s=>({...s,[e]:t}))}else{console.warn(`No forecast data found for version ${s} of project ${e}`);let{data:t,error:r}=await X.from("cost_breakdown").select("*").eq("project_id",e).order("spend_sub_category");if(r)throw r;m(s=>({...s,[e]:t||[]}))}}else{let{data:t,error:s}=await X.from("cost_breakdown").select("*").eq("project_id",e).order("spend_sub_category");if(s)throw s;m(s=>({...s,[e]:t||[]}))}}else if(0===t){console.log(`Loading Version 0 (original) data for project ${e}`);let{data:t,error:s}=await X.from("forecast_versions").select("*").eq("project_id",e).eq("version_number",0).single();if(t&&!s){console.log("Found version 0 in forecast_versions, loading from budget_forecasts");let{data:s,error:r}=await X.from("budget_forecasts").select(`
                *,
                cost_breakdown (*)
              `).eq("forecast_version_id",t.id).order("id");if(r)throw r;let a=s?.map(e=>({...e.cost_breakdown,budget_cost:e.forecasted_cost||e.cost_breakdown.budget_cost,forecast_id:e.id,_original_budget:e.cost_breakdown?.budget_cost}))||[];console.log(`Loaded Version 0 from forecasts for project ${e}:`,a.length,"items"),m(t=>({...t,[e]:a}))}else{console.log("No version 0 found, loading from cost_breakdown table");let{data:t,error:s}=await X.from("cost_breakdown").select("*").eq("project_id",e).order("created_at",{ascending:!0});if(s)throw s;console.log(`Loaded from cost_breakdown for project ${e}:`,t?.length,"items"),m(s=>({...s,[e]:t||[]}))}}else{let{data:s,error:r}=await X.from("forecast_versions").select("*").eq("project_id",e).eq("version_number",t).single();if(r)throw r;let{data:a,error:n}=await X.from("budget_forecasts").select(`
              *,
              cost_breakdown (*)
            `).eq("forecast_version_id",s.id).order("id");if(n)throw console.error("Error loading forecast data:",n),n;if(a&&0!==a.length){let s=a.map(e=>(console.log("Forecast item:",{breakdown_id:e.cost_breakdown?.id,original_budget:e.cost_breakdown?.budget_cost,forecasted_cost:e.forecasted_cost}),{...e.cost_breakdown,budget_cost:e.forecasted_cost,forecast_id:e.id,_original_budget:e.cost_breakdown?.budget_cost}));console.log(`Loaded version ${t} for project ${e}:`,s.length,"items"),console.log("Transformed data sample:",s[0]),m(t=>({...t,[e]:s}))}else{console.warn(`No forecast data found for version ${t} of project ${e}`);let{data:s,error:r}=await X.from("cost_breakdown").select("*").eq("project_id",e).order("spend_sub_category");if(r)throw r;m(t=>({...t,[e]:s||[]}))}}}catch(e){console.error("Error loading version cost breakdown:",e)}finally{Y(t=>({...t,[e]:!1}));let s=`${e}-${t}`;H.current.delete(s)}},eL=async(t,s,r)=>{eP(!0),console.log("[loadComparisonData] Starting comparison load:",{projectId:t,v1:s,v2:r});try{let e={},a=async e=>{let{data:s,error:r}=await X.from("forecast_versions").select("*").eq("project_id",t).eq("version_number",e).single();if(s&&s.id){let{data:t,error:r}=await X.from("budget_forecasts").select("*").eq("forecast_version_id",s.id).order("id");if(r)throw r;return console.log(`[loadComparisonData] Version ${e} forecasts from budget_forecasts:`,{count:t?.length||0,versionId:s.id}),t||[]}if(0!==e)return console.warn(`[loadComparisonData] Version ${e} not found`),[];{let{data:e,error:s}=await X.from("cost_breakdown").select("*").eq("project_id",t).gt("budget_cost",0).order("spend_sub_category");if(s)throw s;return console.log("[loadComparisonData] Version 0 baseline items (budget_cost > 0):",{count:e?.length||0,items:e?.map(e=>({name:e.spend_sub_category,budget_cost:e.budget_cost}))}),e?.map(e=>({id:`v0_${e.id}`,forecast_version_id:"version_0",cost_breakdown_id:e.id,forecasted_cost:e.budget_cost}))||[]}},[n,i]=await Promise.all([a(s),a(r)]);e[s]=n,e[r]=i;let{data:l,error:o}=await X.from("cost_breakdown").select("*").eq("project_id",t).order("cost_line, spend_sub_category");return o?console.error("Error loading cost breakdown:",o):e.originalItems=l||[],console.log("[loadComparisonData] Loaded data:",{v1Count:n.length,v2Count:i.length,originalItemsCount:l?.length||0,v1Sample:n.slice(0,2),v2Sample:i.slice(0,2),originalSample:l?.slice(0,2)}),eS(e),e}catch(t){return console.error("Error loading comparison data:",t),e({variant:"destructive",title:"Failed to Load Comparison Data",description:"Unable to load version data for comparison. Please try again."}),{}}finally{eP(!1)}},e$=async t=>{et(e=>({...e,[t]:!0}));try{let{data:e,error:s}=await X.from("po_mappings").select(`
          id,
          project_id,
          po_number,
          line_item_number,
          cost_breakdown_id,
          amount
        `).eq("project_id",t);if(s)throw s;if(e&&e.length>0){let s=e.map(e=>({po_number:e.po_number,line_item:e.line_item_number})),{data:r,error:a}=await X.from("po_line_items").select(`
            po_number,
            line_item,
            net_value_usd,
            invoiced_value_usd,
            open_value_usd,
            material_description
          `).or(s.map(e=>`and(po_number.eq.${e.po_number},line_item.eq.${e.line_item})`).join(","));if(a)throw a;let n=new Map;r?.forEach(e=>{n.set(`${e.po_number}-${e.line_item}`,e)});let i={total:0,invoiced:0,open:0,mappingCount:e.length,mappings:e.map(e=>{let t=n.get(`${e.po_number}-${e.line_item_number}`);return{...e,lineItemDetails:t||null}})};e.forEach(e=>{let t=n.get(`${e.po_number}-${e.line_item_number}`);if(t){let s=e.amount?e.amount/t.net_value_usd:1;i.total+=t.net_value_usd*s,i.invoiced+=t.invoiced_value_usd*s,i.open+=t.open_value_usd*s}}),J(e=>({...e,[t]:i}))}else J(e=>({...e,[t]:{total:0,invoiced:0,open:0,mappingCount:0,mappings:[]}}))}catch(t){console.error("Error fetching PO mappings:",t),e({variant:"destructive",title:"Failed to Load PO Data",description:"Unable to fetch PO mappings for budget comparison"})}finally{et(e=>({...e,[t]:!1}))}},eA=async e=>{try{let{data:t,error:s}=await X.from("forecast_versions").select("*").eq("project_id",e).order("version_number",{ascending:!1});if(s)throw s;O(s=>({...s,[e]:t||[]}));let r=t?.some(e=>0===e.version_number);return U(t=>({...t,[e]:r||!1})),t||[]}catch(e){return console.error("Error loading forecast versions:",e),[]}},[eV,eO]=(0,a.useState)({}),eZ=e=>{let t=[];return e.forEach((e,s)=>{e.cost_line&&""!==e.cost_line.trim()||t.push(`Entry ${s+1}: Cost line is required`),e.spend_type&&""!==e.spend_type.trim()||t.push(`Entry ${s+1}: Spend type is required`),e.spend_sub_category&&""!==e.spend_sub_category.trim()||t.push(`Entry ${s+1}: Spend sub-category is required`),e.sub_business_line&&""!==e.sub_business_line.trim()||t.push(`Entry ${s+1}: Sub-business line is required`);let r=parseFloat(e.budget_cost);if((isNaN(r)||r<0)&&t.push(`Entry ${s+1}: Budget cost must be a valid positive number`),e.budget_cost&&e.budget_cost.toString().includes(".")){let r=e.budget_cost.toString().split(".")[1];r&&r.length>2&&t.push(`Entry ${s+1}: Budget cost can have maximum 2 decimal places`)}}),{valid:0===t.length,errors:t}},eB=async t=>{B(!0);try{let s,r;let a=ec[t]||[];if(console.log("=== SAVING INITIAL VERSION DEBUG ==="),console.log("Project ID:",t),console.log("Number of staged entries:",a.length),console.log("Staged entries structure:",JSON.stringify(a,null,2)),0===a.length){e({variant:"destructive",title:"No entries to save",description:"Please add at least one entry before saving"}),B(!1);return}let n=eZ(a);if(!n.valid){console.error("Validation errors:",n.errors),e({variant:"destructive",title:"Validation Errors",description:n.errors.join(", ")}),B(!1);return}let i=a.map(e=>ez(e,t));console.log("Cleaned entries for RPC:",JSON.stringify(i,null,2)),console.log("Attempting to save initial version..."),console.log("Using direct database insertion method (RPC bypass)..."),console.log("Using direct insertion method with improved error handling...");let l=[],o=null;try{o=await eT(async()=>{let{data:e,error:s}=await X.from("forecast_versions").insert({project_id:t,version_number:0,reason_for_change:"Initial budget creation",created_by:"system"}).select().single();if(s)throw s;return e},3,1e3);for(let e=0;e<i.length;e+=5)for(let t of i.slice(e,e+5)){let e=await eT(async()=>{let{data:e,error:s}=await X.from("cost_breakdown").insert({...t,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select().single();if(s)throw s;return e},2,500);l.push(e),await eT(async()=>{let{error:s}=await X.from("budget_forecasts").insert({forecast_version_id:o.id,cost_breakdown_id:e.id,forecasted_cost:t.budget_cost,created_at:new Date().toISOString()});if(s)throw s},2,500)}s=[{success:!0,version_id:o.id,message:"Initial forecast created successfully",entries_saved:l.length}],r=null}catch(e){if(console.error("Database insertion failed:",e),o){console.log("Attempting to cleanup partial data...");try{if(await X.from("forecast_versions").delete().eq("id",o.id),l.length>0){let e=l.map(e=>e.id);await X.from("cost_breakdown").delete().in("id",e)}}catch(e){console.error("Cleanup failed:",e)}}r=e,s=null}if(console.log("RPC Response - Data:",s),console.log("RPC Response - Error:",r),r)throw console.error("RPC Error Details:",{message:r.message,details:r.details,hint:r.hint,code:r.code}),r;if(!s||!Array.isArray(s)||0===s.length)throw console.error("Unexpected RPC response format:",s),Error("Invalid response format from RPC function");let d=s[0];if(console.log("RPC Result:",d),!d.success)throw console.error("RPC Function Failed:",d.message),Error(d.message||"RPC function returned failure");U(e=>({...e,[t]:!0})),eh(null),eu(e=>({...e,[t]:[]})),await eF(t),await eA(t),r_.clearBackup(),e({title:"Success",description:"Initial budget saved successfully"})}catch(s){console.error("Error saving initial version:",s);let t="Error saving initial version. ";s?.code==="PGRST202"?t+="The database function is not available. Please contact support.":s?.code==="23505"?t+="An initial version already exists for this project.":s?.code==="22P02"?t+="Invalid data format. Please check all fields are filled correctly.":s?.message?.includes("violates foreign key")?t+="Project reference is invalid. Please refresh and try again.":s?.message?t+=`Details: ${s.message}`:t+="Please check your entries and try again.",e({variant:"destructive",title:"Error Saving",description:t})}finally{B(!1)}},eW=async(e,t)=>{console.log(`Version change requested: ${t} for project ${e}`);let s="latest"===t?"latest":Number.parseInt(t),r=$[e];if(r===s||r?.toString()===s?.toString()){console.log(`Already on version ${s}, skipping reload`);return}console.log(`Switching from version ${$[e]} to ${s}`),A(t=>({...t,[e]:s})),await eI(e,s)},eU=async t=>{N(e=>new Set(e).add(t.id));try{if(t.id&&t.id.startsWith("temp_"))eu(e=>({...e,[t.project_id]:e[t.project_id]?.map(e=>e.id===t.id?{...t,_modified:!0}:e)||[]})),m(e=>({...e,[t.project_id]:e[t.project_id]?.map(e=>e.id===t.id?{...t,_modified:!0}:e)||[]})),console.log("Staged entry updated:",t.id),e({title:"Changes Staged",description:"Your changes will be saved with the initial budget"});else{let{error:e}=await X.from("cost_breakdown").update({sub_business_line:t.sub_business_line,cost_line:t.cost_line,spend_type:t.spend_type,spend_sub_category:t.spend_sub_category,budget_cost:t.budget_cost}).eq("id",t.id);if(e)throw e;m(e=>({...e,[t.project_id]:e[t.project_id]?.map(e=>e.id===t.id?t:e)||[]}))}x(null),f(null)}catch(t){console.error("Error updating cost item:",t),e({variant:"destructive",title:"Update Failed",description:"Failed to update cost item. Please try again."})}finally{N(e=>{let s=new Set(e);return s.delete(t.id),s})}},eq=async(t,s,r,a)=>{if(!s?.trim()){e({variant:"destructive",title:"Validation Error",description:"Please provide a reason for this forecast."});return}B(!0);try{let n=V[t]||[],i=n.length>0?Math.max(...n.map(e=>e.version_number))+1:1,l=[];if(a.length>0){for(let e of(console.log(`Processing ${a.length} new entries for forecast version ${i}`),a)){let s=ez(e,t);console.log("Saving new forecast entry to database:",s);let r=await eT(async()=>{let{data:e,error:t}=await X.from("cost_breakdown").insert([s]).select().single();if(t)throw t;return e},2,500);l.push(r)}console.log(`Added ${l.length} new entries to cost_breakdown`)}let{data:o,error:d}=await X.from("forecast_versions").insert({project_id:t,version_number:i,reason_for_change:s,created_by:"current_user"}).select().single();if(d)throw d;let c=(u[t]||[]).filter(e=>e.id&&!e.id.startsWith("temp_"));console.log("Creating forecast with changes:",r),console.log("Current costs:",c.length),console.log("New entries saved:",l.length);let m=[...c.map(e=>({forecast_version_id:o.id,cost_breakdown_id:e.id,forecasted_cost:void 0!==r[e.id]?r[e.id]:e.budget_cost})),...l.map(e=>({forecast_version_id:o.id,cost_breakdown_id:e.id,forecasted_cost:e.budget_cost}))];if(console.log("Saving forecast entries:",m.length),m.length>0){let{error:e}=await X.from("budget_forecasts").insert(m);if(e)throw e}await eA(t),console.log(`Setting active version to ${i} after save from wizard`),A(e=>({...e,[t]:i})),await new Promise(e=>setTimeout(e,100)),await eI(t,i),z(null),F({}),L(""),ed(new Set),eu(e=>({...e,[t]:[]})),r_.clearBackup(),e({title:"Forecast Saved",description:`Version ${i} has been created successfully`})}catch(t){console.error("Error saving forecast:",t),e({variant:"destructive",title:"Error Saving Forecast",description:t?.message||"Failed to save forecast. Please try again."})}finally{B(!1)}},eY=async(t,s)=>{if(!s?.trim()){e({variant:"destructive",title:"Validation Error",description:"Please provide a reason for this forecast."});return}B(!0);try{let r=V[t]||[],a=r.length>0?Math.max(...r.map(e=>e.version_number))+1:1,n=ec[t]||[],i=[];if(n.length>0)for(let e of(console.log(`Saving ${n.length} new entries to cost_breakdown`),n)){let s=ez(e,t);console.log("Saving entry to database:",s);let r=await eT(async()=>{let{data:e,error:t}=await X.from("cost_breakdown").insert([s]).select().single();if(t)throw t;return e},2,500);i.push(r)}let{data:l,error:o}=await X.from("forecast_versions").insert({project_id:t,version_number:a,reason_for_change:s,created_by:"current_user"}).select().single();if(o)throw o;let d=(u[t]||[]).filter(e=>e.id&&!e.id.startsWith("temp_")).map(e=>({forecast_version_id:l.id,cost_breakdown_id:e.id,forecasted_cost:void 0!==R[e.id]?R[e.id]:e.budget_cost})),c=i.map(e=>({forecast_version_id:l.id,cost_breakdown_id:e.id,forecasted_cost:e.budget_cost})),m=[...d,...c];if(m.length>0){let{error:e}=await X.from("budget_forecasts").insert(m);if(e)throw e}await eA(t),console.log(`Setting active version to ${a} after regular forecast save`),A(e=>({...e,[t]:a})),await new Promise(e=>setTimeout(e,100)),await eI(t,a),z(null),F({}),L(""),ed(new Set),eu(e=>({...e,[t]:[]})),r_.clearBackup(),e({title:"Forecast Saved",description:`Version ${a} has been created successfully`})}catch(r){console.error("Error saving forecast:",r);let s="Error saving forecast. ";r?.message?.includes("temporary fields")?s+="Internal error: temporary fields detected. Please refresh and try again.":r?.code==="PGRST204"?s+="Database schema error. Please contact support.":r?.code==="23505"?s+="Duplicate entry detected. Please check your entries.":r?.code==="22P02"?s+="Invalid data format. Please check all fields.":r?.message?s+=`Details: ${r.message}`:s+="Please check your entries and try again.",e({variant:"destructive",title:"Error Saving",description:s}),console.error("Detailed error context:",{projectId:t,stagedEntriesCount:ec[t]?.length||0,forecastReason:I,error:r})}finally{B(!1)}},eH=e=>{ef(e),z(e),F({}),L("")},eK=e=>{let t=new Set((ec[e]||[]).map(e=>e.id));m(s=>({...s,[e]:(s[e]||[]).filter(e=>!t.has(e.id))})),z(null),F({}),L(""),ed(new Set),eu(t=>({...t,[e]:[]}))},eG=e=>{i(e)},eX=l.filter(e=>e.name.toLowerCase().includes(s.toLowerCase())||e.sub_business_line.toLowerCase().includes(s.toLowerCase())),eQ=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),eJ=e=>e.reduce((e,t)=>e+Number(t.budget_cost),0),e0=async e=>{if(d.has(e.id))c(t=>{let s=new Set(t);return s.delete(e.id),s});else{c(t=>new Set(t).add(e.id)),$[e.id]||A(t=>({...t,[e.id]:"latest"}));let t=V[e.id];t||(t=await eA(e.id)),u[e.id]||(t&&t.length>0?(console.log(`Project ${e.id} has ${t.length} versions, loading latest`),await eI(e.id,"latest")):(console.log(`Project ${e.id} has no versions, loading base cost breakdown`),await eF(e.id))),Q[e.id]||await e$(e.id)}},e1=e=>{x(e.id),f({...e})},e2=()=>{x(null),f(null)},e4=()=>{g&&eU(g)},e6=async e=>{P(!0);try{if(em===e.project_id||M===e.project_id){let t=`temp_${crypto.randomUUID?crypto.randomUUID():`${Date.now()}_${Math.random().toString(36).substr(2,9)}`}`,s={...e,id:t,_tempId:t};eu(t=>({...t,[e.project_id]:[...t[e.project_id]||[],s]})),m(t=>({...t,[e.project_id]:[...t[e.project_id]||[],s]}))}else{let{error:t}=await X.from("cost_breakdown").insert([e]).select().single();if(t)throw t;await eF(e.project_id)}}catch(e){console.error("Error adding new cost entry:",e)}finally{P(!1)}},e3=async t=>{T(t);try{let e=Object.keys(u).find(e=>u[e].some(e=>e.id===t));if(!e)throw Error("Could not find project for cost entry");if(t&&t.startsWith("temp_"))eu(s=>({...s,[e]:s[e]?.filter(e=>e.id!==t)||[]})),m(s=>({...s,[e]:s[e]?.filter(e=>e.id!==t)||[]})),console.log("Staged entry deleted:",t);else{let{error:s}=await X.from("cost_breakdown").delete().eq("id",t);if(s)throw s;await eF(e)}}catch(t){console.error("Error deleting cost entry:",t),e({variant:"destructive",title:"Delete Failed",description:"Failed to delete cost entry. Please try again."})}finally{T(null)}},e5=async e=>{G(e);try{let{error:t}=await X.from("projects").delete().eq("id",e);if(t)throw t;await eR()}catch(e){console.error("Error deleting project:",e)}finally{G(null)}},e7=async()=>{el(!0);try{let{data:e,error:t}=await X.from("projects").insert([ea]).select().single();if(t)throw t;await eR(),er(!1),en({name:"",sub_business_line:""})}catch(t){console.error("Error creating new project:",t),e({variant:"destructive",title:"Error Creating Project",description:"Error creating new project. Please try again."})}finally{el(!1)}},e8=(e,t)=>{F(s=>({...s,[e]:t}))},e9=e=>{eh(e),eu(t=>({...t,[e]:[]}))},te=e=>{let t=new Set((ec[e]||[]).map(e=>e.id));m(s=>({...s,[e]:(s[e]||[]).filter(e=>!t.has(e.id))})),eh(null),eu(t=>({...t,[e]:[]}))},tt=async e=>{em===e?await eB(e):M===e&&await eY(e,I)},ts=t=>{confirm("Are you sure you want to discard all unsaved changes?")&&(eu(e=>({...e,[t]:[]})),m(e=>({...e,[t]:e[t]?.map(e=>({...e,_modified:!1}))||[]})),e({title:"Changes Discarded",description:"All unsaved changes have been discarded"}))},tr=async t=>{if(0===eb.size||!confirm(`Are you sure you want to delete ${eb.size} selected entries?`))return;let s=Array.from(eb),r=0;for(let e of s)try{if(e.startsWith("temp_"))eu(s=>({...s,[t]:s[t]?.filter(t=>t.id!==e)||[]})),m(s=>({...s,[t]:s[t]?.filter(t=>t.id!==e)||[]}));else{let{error:t}=await X.from("cost_breakdown").delete().eq("id",e);!t&&r++}}catch(t){console.error(`Failed to delete entry ${e}:`,t)}r>0&&await eF(t),ev(new Set),e({title:"Bulk Delete Complete",description:`Successfully deleted ${r} entries`})},ta=(e,t)=>{let s=u[e]||[];t?ev(new Set(s.map(e=>e.id))):ev(new Set)},tn=e=>{ev(t=>{let s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})};return(0,r.jsxs)("div",{className:"container mx-auto p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Cost Management Hub"}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[r.jsx(rE,{}),(0,r.jsxs)("div",{className:"relative",children:[r.jsx("input",{type:"text",placeholder:"Search projects...",value:s,onChange:e=>eG(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),r.jsx("svg",{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),!es&&r.jsx("button",{onClick:()=>er(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Create New Project"})]})]}),es&&(0,r.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-4",children:"Create New Project"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project Name"}),r.jsx("input",{type:"text",value:ea.name,onChange:e=>en({...ea,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter project name"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sub Business Line"}),(0,r.jsxs)("select",{value:ea.sub_business_line,onChange:e=>en({...ea,sub_business_line:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"",children:"Select sub business line"}),rM.map(e=>r.jsx("option",{value:e,children:e},e))]})]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:e7,disabled:ei||!ea.name.trim()||!ea.sub_business_line.trim(),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:ei?"Creating...":"Create Project"}),r.jsx("button",{onClick:()=>{er(!1),en({name:"",sub_business_line:""})},className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})]})]}),j?(0,r.jsxs)("div",{className:"text-center py-8",children:[r.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),r.jsx("p",{className:"mt-2 text-gray-600",children:"Loading projects..."})]}):0===eX.length?r.jsx("div",{className:"text-center py-8",children:r.jsx("p",{className:"text-gray-600",children:"No projects found."})}):r.jsx("div",{className:"space-y-4",children:eX.map(e=>r.jsx("div",{className:"bg-white border border-gray-200 rounded-lg",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[r.jsx("button",{onClick:()=>e0(e),className:"text-blue-600 hover:text-blue-800 transition-colors",children:r.jsx("svg",{className:`h-5 w-5 transform transition-transform ${d.has(e.id)?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-xl font-semibold",children:e.name}),r.jsx("p",{className:"text-gray-600",children:e.sub_business_line})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[u[e.id]&&(0,r.jsxs)("div",{className:"text-right",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Total Budget"}),r.jsx("p",{className:"text-lg font-semibold text-green-600",children:eQ(eJ(u[e.id]))})]}),(0,r.jsxs)("button",{onClick:()=>t.push(`/projects/${e.id}/dashboard`),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[r.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Dashboard"]}),r.jsx("button",{onClick:()=>{confirm("Are you sure you want to delete this project? This will permanently delete all project data including budgets, versions, and cost breakdowns.")&&e5(e.id)},disabled:K===e.id,className:"text-red-600 hover:text-red-800 disabled:opacity-50 transition-colors",children:K===e.id?r.jsx("div",{className:"inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-red-600"}):r.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),d.has(e.id)&&(0,r.jsxs)("div",{className:"mt-6 border-t pt-6",children:[Q[e.id]&&r.jsx("div",{className:"mb-6",children:r.jsx(rD,{budget:eJ(u[e.id]||[]),actual:Q[e.id],loading:ee[e.id],className:"mb-4",onViewDetails:()=>{t.push(`/po-mapping?project=${e.id}`)}})}),V[e.id]&&V[e.id].length>0&&r.jsx("div",{className:"mb-6",children:r.jsx(tC,{versions:V[e.id],currentVersion:$[e.id]||"latest",onVersionSelect:t=>eW(e.id,t.toString()),onCompareVersions:async(t,s)=>{eC({v1:t,v2:s}),eN(e.id),await eL(e.id,t,s)},isLoading:q[e.id]})}),(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h4",{className:"text-lg font-semibold",children:"Cost Breakdown"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[V[e.id]&&V[e.id].length>0&&(0,r.jsxs)("select",{value:$[e.id]?.toString()||"latest",onChange:t=>{console.log("Dropdown changed to:",t.target.value),eW(e.id,t.target.value)},className:"px-3 py-1 border border-gray-300 rounded-md text-sm",disabled:q[e.id],children:[r.jsx("option",{value:"latest",children:"Latest"}),r.jsx("option",{value:"0",children:"Version 0 (Original)"}),V[e.id].filter(e=>0!==e.version_number).map(e=>(0,r.jsxs)("option",{value:e.version_number.toString(),children:["Version ",e.version_number]},e.id))]}),em===e.id?(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("span",{className:"text-sm text-blue-600 font-medium",children:["Initial Budget Mode (",ec[e.id]?.length||0," entries)"]}),r.jsx("button",{onClick:()=>eB(e.id),disabled:Z||0===(ec[e.id]?.length||0),className:"bg-green-600 text-white px-3 py-1 rounded-md text-sm hover:bg-green-700 disabled:opacity-50 transition-colors",children:Z?"Saving...":"Save Initial Budget"}),r.jsx("button",{onClick:()=>te(e.id),className:"bg-gray-500 text-white px-3 py-1 rounded-md text-sm hover:bg-gray-600 transition-colors",children:"Cancel"})]}):M===e.id?(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("span",{className:"text-sm text-blue-600 font-medium",children:["Forecasting Mode (",Object.keys(R).length+(ec[e.id]?.length||0)," ","changes)"]}),r.jsx("input",{type:"text",placeholder:"Reason for forecast...",value:I,onChange:e=>L(e.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm"}),r.jsx("button",{onClick:()=>eY(e.id,I),disabled:Z||!I.trim(),className:"bg-green-600 text-white px-3 py-1 rounded-md text-sm hover:bg-green-700 disabled:opacity-50 transition-colors",children:Z?"Saving...":"Save Forecast"}),r.jsx("button",{onClick:()=>eK(e.id),className:"bg-gray-500 text-white px-3 py-1 rounded-md text-sm hover:bg-gray-600 transition-colors",children:"Cancel"})]}):r.jsx("div",{className:"flex items-center gap-2",children:W[e.id]||u[e.id]&&0!==u[e.id].length?!W[e.id]&&u[e.id]?.length>0?r.jsx("button",{onClick:()=>eB(e.id),className:"bg-blue-600 text-white px-3 py-1 rounded-md text-sm hover:bg-blue-700 transition-colors",children:"Save Initial Version"}):r.jsx("button",{onClick:()=>eH(e.id),className:"bg-orange-600 text-white px-3 py-1 rounded-md text-sm hover:bg-orange-700 transition-colors",children:"Create New Forecast"}):r.jsx("button",{onClick:()=>e9(e.id),className:"bg-blue-600 text-white px-3 py-1 rounded-md text-sm hover:bg-blue-700 transition-colors",children:"Create Initial Budget"})})]})]}),q[e.id]?(0,r.jsxs)("div",{className:"text-center py-4",children:[r.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),r.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Loading version data..."})]}):(0,r.jsxs)(r.Fragment,{children:[u[e.id]&&0!==u[e.id].length||em?u[e.id]&&u[e.id].length>0?r.jsx("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[r.jsx("thead",{children:(0,r.jsxs)("tr",{className:"bg-gray-50",children:[(M===e.id||em===e.id)&&r.jsx("th",{className:"border border-gray-300 px-2 py-2 text-center",children:r.jsx("input",{type:"checkbox",onChange:t=>ta(e.id,t.target.checked),checked:u[e.id]?.length>0&&u[e.id].every(e=>eb.has(e.id)),className:"w-4 h-4"})}),r.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Status"}),r.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Cost Line"}),r.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Spend Type"}),r.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Sub Category"}),r.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Budget Cost"}),r.jsx("th",{className:"border border-gray-300 px-4 py-2 text-center",children:"Actions"})]})}),r.jsx("tbody",{children:u[e.id].map(t=>(0,r.jsxs)("tr",{className:eD(t),children:[(M===e.id||em===e.id)&&r.jsx("td",{className:"border border-gray-300 px-2 py-2 text-center",children:r.jsx("input",{type:"checkbox",checked:eb.has(t.id),onChange:()=>tn(t.id),className:"w-4 h-4"})}),h===t.id&&(M===e.id||em===e.id)?(0,r.jsxs)(r.Fragment,{children:[r.jsx("td",{className:"border border-gray-300 px-4 py-2",children:r.jsx(p,{id:t.id,modified:t._modified,saving:w.has(t.id)})}),r.jsx("td",{className:"border border-gray-300 px-4 py-2",children:(0,r.jsxs)("select",{value:g?.cost_line||"",onChange:e=>f(g?{...g,cost_line:e.target.value}:null),className:"w-full px-2 py-1 border border-gray-300 rounded",children:[r.jsx("option",{value:"",children:"Select cost line"}),rz.map(e=>r.jsx("option",{value:e,children:e},e))]})}),r.jsx("td",{className:"border border-gray-300 px-4 py-2",children:(0,r.jsxs)("select",{value:g?.spend_type||"",onChange:e=>f(g?{...g,spend_type:e.target.value}:null),className:"w-full px-2 py-1 border border-gray-300 rounded",children:[r.jsx("option",{value:"",children:"Select spend type"}),rR.map(e=>r.jsx("option",{value:e,children:e},e))]})}),r.jsx("td",{className:"border border-gray-300 px-4 py-2",children:r.jsx("input",{type:"text",value:g?.spend_sub_category||"",onChange:e=>f(g?{...g,spend_sub_category:e.target.value}:null),className:"w-full px-2 py-1 border border-gray-300 rounded"})}),r.jsx("td",{className:"border border-gray-300 px-4 py-2",children:r.jsx("input",{type:"number",value:g?.budget_cost||"",onChange:e=>f(g?{...g,budget_cost:Number(e.target.value)}:null),className:"w-full px-2 py-1 border border-gray-300 rounded text-right"})}),r.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:(0,r.jsxs)("div",{className:"flex gap-1 justify-center",children:[r.jsx("button",{onClick:e4,disabled:w.has(t.id),className:"bg-green-600 text-white px-2 py-1 rounded text-xs hover:bg-green-700 disabled:opacity-50 transition-colors",children:w.has(t.id)?"...":"Save"}),r.jsx("button",{onClick:e2,className:"bg-gray-500 text-white px-2 py-1 rounded text-xs hover:bg-gray-600 transition-colors",children:"Cancel"})]})})]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx("td",{className:"border border-gray-300 px-4 py-2",children:r.jsx(p,{id:t.id,modified:t._modified,saving:w.has(t.id)})}),r.jsx("td",{className:"border border-gray-300 px-4 py-2",children:t.cost_line}),r.jsx("td",{className:"border border-gray-300 px-4 py-2",children:t.spend_type}),r.jsx("td",{className:"border border-gray-300 px-4 py-2",children:t.spend_sub_category}),r.jsx("td",{className:"border border-gray-300 px-4 py-2 text-right",children:M===e.id?r.jsx(rC,{value:R[t.id]??t.budget_cost,onSave:e=>e8(t.id,Number(e)),type:"number",formatter:e=>eQ(e),validator:e=>{let t=Number(e);return!isNaN(t)&&!(t<0)||"Value must be a positive number"},className:"text-right"}):eQ(t.budget_cost)}),r.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:(M===e.id||em===e.id)&&(0,r.jsxs)("div",{className:"flex gap-1 justify-center",children:[r.jsx("button",{onClick:()=>e1(t),className:"bg-blue-600 text-white px-2 py-1 rounded text-xs hover:bg-blue-700 transition-colors",children:"Edit"}),r.jsx("button",{onClick:()=>{confirm("Are you sure you want to delete this cost entry?")&&e3(t.id)},disabled:D===t.id,className:"bg-red-600 text-white px-2 py-1 rounded text-xs hover:bg-red-700 disabled:opacity-50 transition-colors",children:D===t.id?"...":"Delete"})]})})]})]},t.id))})]})}):null:(0,r.jsxs)("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[r.jsx("p",{className:"text-gray-600 mb-4",children:"No budget has been created for this project yet."}),r.jsx("p",{className:"text-sm text-gray-500",children:'Click "Create Initial Budget" to get started.'})]}),(M===e.id||em===e.id)&&r.jsx("div",{className:"mt-4",children:_===e.id?(0,r.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[r.jsx("h5",{className:"font-semibold mb-3",children:"Add New Cost Entry"}),(0,r.jsxs)("div",{className:"grid grid-cols-4 gap-3 mb-3",children:[(0,r.jsxs)("select",{value:k?.cost_line||"",onChange:t=>S(k?{...k,cost_line:t.target.value}:{project_id:e.id,sub_business_line:e.sub_business_line,cost_line:t.target.value,spend_type:"",spend_sub_category:"",budget_cost:0}),className:"px-3 py-2 border border-gray-300 rounded-md",children:[r.jsx("option",{value:"",children:"Select cost line"}),rz.map(e=>r.jsx("option",{value:e,children:e},e))]}),(0,r.jsxs)("select",{value:k?.spend_type||"",onChange:t=>S(k?{...k,spend_type:t.target.value}:{project_id:e.id,sub_business_line:e.sub_business_line,cost_line:"",spend_type:t.target.value,spend_sub_category:"",budget_cost:0}),className:"px-3 py-2 border border-gray-300 rounded-md",children:[r.jsx("option",{value:"",children:"Select spend type"}),rR.map(e=>r.jsx("option",{value:e,children:e},e))]}),r.jsx("input",{type:"text",placeholder:"Sub Category",value:k?.spend_sub_category||"",onChange:t=>S(k?{...k,spend_sub_category:t.target.value}:{project_id:e.id,sub_business_line:e.sub_business_line,cost_line:"",spend_type:"",spend_sub_category:t.target.value,budget_cost:0}),className:"px-3 py-2 border border-gray-300 rounded-md"}),r.jsx("input",{type:"number",placeholder:"Budget Cost",value:k?.budget_cost||"",onChange:t=>S(k?{...k,budget_cost:Number(t.target.value)}:{project_id:e.id,sub_business_line:e.sub_business_line,cost_line:"",spend_type:"",spend_sub_category:"",budget_cost:Number(t.target.value)}),className:"px-3 py-2 border border-gray-300 rounded-md"})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>{k&&(e6(k),C(null),S(null))},disabled:E||!k?.cost_line||!k?.spend_type||!k?.spend_sub_category,className:"bg-green-600 text-white px-3 py-2 rounded-md hover:bg-green-700 disabled:opacity-50 transition-colors",children:E?"Adding...":"Add Entry"}),r.jsx("button",{onClick:()=>{C(null),S(null)},className:"bg-gray-500 text-white px-3 py-2 rounded-md hover:bg-gray-600 transition-colors",children:"Cancel"})]})]}):r.jsx("button",{onClick:()=>C(e.id),className:`px-4 py-2 rounded-lg transition-colors ${M===e.id?"bg-orange-600 text-white hover:bg-orange-700":"bg-blue-600 text-white hover:bg-blue-700"}`,children:"Add New Entry"})})]})]})]})},e.id))}),ew&&e_&&(()=>{let e=l.find(e=>e.id===ew),t=ek[e_.v1]||[],s=ek[e_.v2]||[],a=ek.originalItems||[],n=new Set,i=new Map;t.forEach(e=>{n.add(e.cost_breakdown_id)}),s.forEach(e=>{n.add(e.cost_breakdown_id)}),a.length>0?a.forEach(e=>{if(n.has(e.id)){let t=e.spend_sub_category||e.cost_line||"Unknown";e.cost_line&&e.spend_sub_category&&e.cost_line!==e.spend_sub_category&&(t=`${e.cost_line} - ${e.spend_sub_category}`),i.set(e.id,{id:e.id,name:t})}}):(u[ew]||[]).forEach(e=>{if(n.has(e.id)){let t=e.spend_sub_category||e.cost_line||"Unknown";e.cost_line&&e.spend_sub_category&&e.cost_line!==e.spend_sub_category&&(t=`${e.cost_line} - ${e.spend_sub_category}`),i.set(e.id,{id:e.id,name:t})}});let o=Array.from(n).map(e=>{let s=t.find(t=>t.cost_breakdown_id===e),r=i.get(e);return{costLineName:r?.name||"Unknown",totalCost:s&&s.forecasted_cost||0}}),d=o.reduce((e,t)=>e+t.totalCost,0),c=Array.from(n).map(e=>{let t=s.find(t=>t.cost_breakdown_id===e),r=i.get(e);return{costLineName:r?.name||"Unknown",totalCost:t&&t.forecasted_cost||0}}),m=c.reduce((e,t)=>e+t.totalCost,0);console.log("[Version Comparison] Data transformation:",{v1:e_.v1,v2:e_.v2,v1ForecastCount:t.length,v2ForecastCount:s.length,v1Total:d,v2Total:m,costItemCount:n.size,originalItemsCount:a.length,costItemMapEntries:Array.from(i.entries()).map(([e,t])=>({id:e.substring(0,8)+"...",name:t.name})),v1Items:o.filter(e=>e.totalCost>0).map(e=>({name:e.costLineName,cost:e.totalCost})),v2Items:c.filter(e=>e.totalCost>0).map(e=>({name:e.costLineName,cost:e.totalCost}))});let h=[{version:e_.v1,totalCost:d,costLines:o},{version:e_.v2,totalCost:m,costLines:c}];return r.jsx(rj,{isOpen:!0,onClose:()=>{eN(null),eC(null),eS({})},projectData:{id:ew,name:e?.name||""},versions:h,mode:"sheet",showAdvancedFeatures:!1})})(),eg&&r.jsx(tv,{isOpen:!0,onClose:()=>{ef(null),z(null),F({}),L("")},projectId:eg,projectName:l.find(e=>e.id===eg)?.name||"",currentCosts:u[eg]||[],stagedEntries:ec[eg]||[],onSave:async(e,t,s)=>{await eq(eg,s,e,t),ef(null)},onAddEntry:e=>{e6(e)},onUpdateEntry:e=>{eU(e)},onDeleteEntry:e=>{e3(e)}}),Array.from(d).map(e=>ex[e]>0&&r.jsx(v,{count:ex[e],onSave:()=>tt(e),onDiscard:()=>ts(e)},`unsaved-${e}`)),eb.size>0&&r.jsx("div",{className:"fixed bottom-4 left-1/2 transform -translate-x-1/2 bg-white shadow-lg rounded-lg p-4 border border-gray-200 z-50",children:(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)("span",{className:"font-medium",children:[eb.size," items selected"]}),r.jsx(b.z,{onClick:()=>{let e=Array.from(d)[0];e&&tr(e)},variant:"destructive",size:"sm",children:"Delete Selected"}),r.jsx(b.z,{onClick:()=>ev(new Set),variant:"outline",size:"sm",children:"Clear Selection"})]})})]})}},76240:(e,t,s)=>{"use strict";s.d(t,{Cd:()=>o,X:()=>d,bZ:()=>l});var r=s(30817);s(19196);var a=s(84766),n=s(61601);let i=(0,a.j)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function l({className:e,variant:t,...s}){return r.jsx("div",{"data-slot":"alert",role:"alert",className:(0,n.cn)(i({variant:t}),e),...s})}function o({className:e,...t}){return r.jsx("div",{"data-slot":"alert-title",className:(0,n.cn)("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",e),...t})}function d({className:e,...t}){return r.jsx("div",{"data-slot":"alert-description",className:(0,n.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",e),...t})}},94969:(e,t,s)=>{"use strict";s.d(t,{_:()=>i});var r=s(30817);s(19196);var a=s(44041),n=s(61601);function i({className:e,...t}){return r.jsx(a.f,{"data-slot":"label",className:(0,n.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...t})}},25478:(e,t,s)=>{"use strict";s.d(t,{E:()=>i});var r=s(30817);s(19196);var a=s(98652),n=s(61601);function i({className:e,value:t,...s}){return r.jsx(a.fC,{"data-slot":"progress",className:(0,n.cn)("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",e),...s,children:r.jsx(a.z$,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})})}},32141:(e,t,s)=>{"use strict";s.d(t,{Dp:()=>d,ee:()=>o,pO:()=>l});var r=s(30817);s(19196);var a=s(95312),n=s(70090),i=s(61601);function l({className:e,...t}){return r.jsx(n.eh,{"data-slot":"resizable-panel-group",className:(0,i.cn)("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",e),...t})}function o({...e}){return r.jsx(n.s_,{"data-slot":"resizable-panel",...e})}function d({withHandle:e,className:t,...s}){return r.jsx(n.OT,{"data-slot":"resizable-handle",className:(0,i.cn)("bg-border focus-visible:ring-ring relative flex w-px items-center justify-center after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:ring-1 focus-visible:ring-offset-1 focus-visible:outline-hidden data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:translate-x-0 data-[panel-group-direction=vertical]:after:-translate-y-1/2 [&[data-panel-group-direction=vertical]>div]:rotate-90",t),...s,children:e&&r.jsx("div",{className:"bg-border z-10 flex h-4 w-3 items-center justify-center rounded-xs border",children:r.jsx(a.Z,{className:"size-2.5"})})})}},55633:(e,t,s)=>{"use strict";s.d(t,{Bw:()=>m,Ph:()=>d,Ql:()=>h,i4:()=>u,ki:()=>c});var r=s(30817);s(19196);var a=s(70678),n=s(18426),i=s(86867),l=s(50839),o=s(61601);function d({...e}){return r.jsx(a.fC,{"data-slot":"select",...e})}function c({...e}){return r.jsx(a.B4,{"data-slot":"select-value",...e})}function u({className:e,size:t="default",children:s,...i}){return(0,r.jsxs)(a.xz,{"data-slot":"select-trigger","data-size":t,className:(0,o.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...i,children:[s,r.jsx(a.JO,{asChild:!0,children:r.jsx(n.Z,{className:"size-4 opacity-50"})})]})}function m({className:e,children:t,position:s="popper",...n}){return r.jsx(a.h_,{children:(0,r.jsxs)(a.VY,{"data-slot":"select-content",className:(0,o.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===s&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:s,...n,children:[r.jsx(x,{}),r.jsx(a.l_,{className:(0,o.cn)("p-1","popper"===s&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),r.jsx(p,{})]})})}function h({className:e,children:t,...s}){return(0,r.jsxs)(a.ck,{"data-slot":"select-item",className:(0,o.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",e),...s,children:[r.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:r.jsx(a.wU,{children:r.jsx(i.Z,{className:"size-4"})})}),r.jsx(a.eT,{children:t})]})}function x({className:e,...t}){return r.jsx(a.u_,{"data-slot":"select-scroll-up-button",className:(0,o.cn)("flex cursor-default items-center justify-center py-1",e),...t,children:r.jsx(l.Z,{className:"size-4"})})}function p({className:e,...t}){return r.jsx(a.$G,{"data-slot":"select-scroll-down-button",className:(0,o.cn)("flex cursor-default items-center justify-center py-1",e),...t,children:r.jsx(n.Z,{className:"size-4"})})}},38723:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var r=s(30817);s(19196);var a=s(82087),n=s(61601);function i({className:e,orientation:t="horizontal",decorative:s=!0,...i}){return r.jsx(a.f,{"data-slot":"separator",decorative:s,orientation:t,className:(0,n.cn)("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",e),...i})}},64221:(e,t,s)=>{"use strict";s.d(t,{g:()=>n});var r=s(30817);s(19196);var a=s(61601);function n({className:e,...t}){return r.jsx("textarea",{"data-slot":"textarea",className:(0,a.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...t})}},86844:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(50367).Z)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]])},44380:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(50367).Z)("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]])},25616:(e,t,s)=>{"use strict";function r(){return null}s.r(t),s.d(t,{default:()=>r})},58643:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(73883).createProxy)(String.raw`/home/iwahbi/dev/cost-management-v0/apps/web/app/projects/page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[379,611,579,729,478,177],()=>s(22186));module.exports=r})();