I am building a web app using nextjs and supabase as my database, I am using agentic development workflow where I have a set of agents working together to iteratively add functionality and features to this web app. The development workflow I am using consists of 4 phases, diagnose, design ideation, planning, implementation. Each agent creates context as md file for the next agent all the way until the implementation. The workflow itself is kind of working well, but I started feeling it is getting challenging for the agents as the codebase growing bigger.
I didn’t define a standard way for the agents to follow in terms of codebase architecture. I see some files like one for a page having now 3000 lines of code.

Your objective is to research and brainstorm what kind of architecture we can implement where we can maintain manageable codebase and avoid monstrous files best optimised for agentic development. Say we have a page with several cards, a table, several buttons with different functionalities several features, what is the agentic AI optimum architecture? It shouldn’t necessarily be a human optimum one, our main objective is to have architecture where agents can do development with minimal problems and least amount of bugs and being able to add features fix existing bugs all the way to an extensive feature rich web app while not struggling in adding more feaures and expanding the functionality both frontend UI UX and databse backend like supabase.

Ultrathink and let’s explore together in finding this optimum architecture that can allow AI agents to develop a sophisticated highly complex nextjs web app, without losing track of anything and being able to keep adding features and changing thinfs effortlessly, need to make sure such architecture could be something that no one has thought of before or a hybrid of different ideas, why I think that because us human we have our own optimal architecture for development, but AI agents have different problems than us, they operate differently so we need to have something this fundamentally desinged for their own abilities, strengths and weaknesses

From my experience so far when I first started adding functionality and adding new elements and components to a mockup I had initially, I noticed when I asked to improve the UX/UI of for example how we’re displaying budget comparisons the agentic workflow created new sheet component and left out an older tsx file, it was very confusing later for the agent to add and iterate more, as it started updating the old tsx which was not even being used! While this can be resolved in refining the agents in the workflow by enhancing their system prompts, I still think besides this an optimal architecture for agents would solve this but what is it!

Another example is initially I had a table in the databse which we record the budget in it, I wanted to add a versioned budget functionality which required creating a new table and create a relationship to capture each version budgets and how they changed but the agents struggled a lot to reflect this into the UI as table visual, I had to iterate multiple times trying to explain what I’m seeing is not what is in the databse table itself, the same problem I faced when I wanted to add some UI elements to show comparison between the versions, it kept showing wrong numbers.

Another example is I had a waterfall plot working and I asked the workflow to enhance the UI and UX of the entire comparison compnent, and to keep the waterfall in one of the tabs within, but later I saw the waterfall not showing the granular values I used to see before.

Imagine what would happen when we start having tens of tables tens of UI plots and visuals.

What kind of architecture can prevent all this from happening?

Ultrathink

As explained our development workflow follows an iterative approach what I struggle with the most is when I do the diagnose, ideate, plan, implement flow, I always dont get what I initially wanted from the first flow, either ends up with a bug, data not showing, UI issues or other things and I have to continue with the implement agent in the same conversation to try and fix these issues. But we know the biggest weakness is context limitations. Ideally maybe we can start new session and talk with the implement agent about the issue we had after the initial implementation and it fixes it or even better increase the reliability where the agentic workflow can nail it from the first iteration.

What sort of architecture enhancement we can add to our latest ideas to tackle such issues too?

I want you to stress test this new framework against all the problems we identified and discussed previously in great depth, will this framework and architecture prevent all these problems from happening?

Remember that when we are taking a simple webapp we still don’t have clear idea of how the final product would look, we are going to iteratively add features and get inspired by new ideas that triggers for the human ideas for new features or changing and revamping existing one, we would go through the diagnose, ideate designs, plan, implement development workflow maybe thousands of times to get to that finished sophisticated product, where our agents would not struggle as we make our product bigger and bigger, we go from for example add for me a feature where I can allow users to create budgets by adding line entries and save them under a project, he we dont even have that table in the database and we would let the ideator come up with designs and plan and implement one, we should maximize the chance of having our workflow successfully implement things in one shot achieving highest reliability, we might then say ok let’s add another feature to allow users to create versioned budget forecasts with absolute best UI and UX, here the agentic workflow would need to add one more table for the versions create relationships and reflect the data on the UI correctly, this can grow all the way to having a fully sophisticated project control feature that has hundreds of features allowing users to interact with the web app defining budgets, editing and creating new versions, creating budget comparisons with fully fledged dashboards UI plots. Imagine this happening thousands of times for thousands of features, how will our architecture allow our workflow to maintain the highest level of reliability at all times. Also keeping in mind that our human is driving things by prompting the workflow, we should have an architecture where he can easily prompt the agentic workflow and they understand what needs to be done without both of them getting lost. Get inspired and ultrathink